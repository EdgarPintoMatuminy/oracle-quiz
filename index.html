<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Oracle 1z0-133 Quiz Mejorado - 127 Preguntas</title>
<style>
*{margin:0;padding:0;box-sizing:border-box}body{font-family:'Segoe UI',sans-serif;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);min-height:100vh;padding:20px}.container{max-width:900px;margin:0 auto;background:white;border-radius:20px;box-shadow:0 20px 60px rgba(0,0,0,0.3);overflow:hidden}.header{background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);color:white;padding:30px;text-align:center}.header h1{font-size:28px;margin-bottom:10px}.header p{font-size:16px;opacity:0.9}.config-panel{background:#f8f9ff;padding:25px;border-bottom:3px solid #667eea}.config-row{display:flex;gap:15px;margin-bottom:15px;flex-wrap:wrap;align-items:center}.config-group{flex:1;min-width:200px}.config-label{font-size:14px;font-weight:600;color:#667eea;margin-bottom:8px;display:block}.config-input{width:100%;padding:10px;border:2px solid #e0e0e0;border-radius:8px;font-size:14px;transition:border-color 0.3s}.config-input:focus{outline:none;border-color:#667eea}.btn-config{background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);color:white;padding:12px 25px;border:none;border-radius:8px;font-size:15px;font-weight:600;cursor:pointer;transition:all 0.3s}.btn-config:hover{transform:translateY(-2px);box-shadow:0 5px 15px rgba(102,126,234,0.4)}.checkbox-container{display:flex;align-items:center;gap:10px}.checkbox-container input[type="checkbox"]{width:20px;height:20px;cursor:pointer}.progress-bar{background:#f0f0f0;height:8px;position:relative}.progress-fill{background:linear-gradient(90deg,#667eea 0%,#764ba2 100%);height:100%;width:0%;transition:width 0.3s ease}.quiz-content{padding:40px}.question-number{color:#667eea;font-weight:bold;font-size:14px;margin-bottom:15px}.question-text{font-size:18px;color:#333;margin-bottom:25px;line-height:1.6}.options{display:flex;flex-direction:column;gap:12px}.option{padding:15px 20px;border:2px solid #e0e0e0;border-radius:10px;cursor:pointer;transition:all 0.3s ease;background:white;font-size:16px}.option:hover{border-color:#667eea;background:#f8f9ff;transform:translateX(5px)}.option.selected{border-color:#667eea;background:#f8f9ff}.option.correct{border-color:#10b981;background:#d1fae5;color:#065f46}.option.incorrect{border-color:#ef4444;background:#fee2e2;color:#991b1b}.option.disabled{cursor:not-allowed;opacity:0.7}.controls{display:flex;justify-content:space-between;margin-top:30px;gap:15px}button{padding:12px 30px;border:none;border-radius:10px;font-size:16px;font-weight:600;cursor:pointer;transition:all 0.3s ease}.btn-check{background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);color:white;flex:1}.btn-check:hover{transform:translateY(-2px);box-shadow:0 5px 15px rgba(102,126,234,0.4)}.btn-check:disabled{background:#ccc;cursor:not-allowed;transform:none}.btn-next{background:#10b981;color:white}.btn-next:hover{background:#059669;transform:translateY(-2px)}.btn-prev{background:#6b7280;color:white}.btn-prev:hover{background:#4b5563}.result-message{margin-top:20px;padding:15px;border-radius:10px;text-align:center;font-weight:600;display:none}.result-message.correct{background:#d1fae5;color:#065f46;display:block}.result-message.incorrect{background:#fee2e2;color:#991b1b;display:block}.score-board{background:#f8f9ff;padding:20px;border-radius:10px;margin-bottom:20px;display:flex;justify-content:space-around;text-align:center}.score-item{display:flex;flex-direction:column}.score-label{font-size:14px;color:#666;margin-bottom:5px}.score-value{font-size:24px;font-weight:bold;color:#667eea}.final-results{text-align:center;padding:40px}.final-results h2{font-size:32px;color:#667eea;margin-bottom:20px}.final-score{font-size:48px;font-weight:bold;color:#10b981;margin:20px 0}.restart-btn{background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);color:white;margin-top:20px}.option-letter{display:inline-block;width:30px;height:30px;border-radius:50%;background:#667eea;color:white;text-align:center;line-height:30px;margin-right:10px;font-weight:bold}.correct .option-letter{background:#10b981}.incorrect .option-letter{background:#ef4444}.hidden{display:none}.info-message{background:#fef3c7;border:2px solid #f59e0b;color:#92400e;padding:15px;border-radius:10px;margin-bottom:20px;text-align:center;font-weight:600}
.translation{font-size:11px;color:#888;font-style:italic;margin-top:5px;line-height:1.3}
.btn-back-home{background:#6b7280;color:white;font-size:14px;padding:8px 16px}
.btn-back-home:hover{background:#4b5563}
body.dark-mode{background:linear-gradient(135deg,#1a1a2e 0%,#16213e 100%)}
.dark-mode .container{background:#252b42;color:#e0e0e0}
.dark-mode .config-panel{background:#1e2439}
.dark-mode .config-input{background:#2d3548;border-color:#3d4558;color:#e0e0e0}
.dark-mode .option{background:#2d3548;border-color:#3d4558;color:#e0e0e0}
.dark-mode .option:hover{background:#353d54}
.dark-mode .option.selected{background:#353d54}
.dark-mode .score-board{background:#1e2439}
.dark-mode .score-label{color:#9ca3af}
.dark-mode .question-text{color:#e0e0e0}
.dark-mode .translation{color:#9ca3af}
.dark-mode-toggle{position:absolute;top:20px;right:20px;background:rgba(255,255,255,0.2);border:none;color:white;padding:8px 16px;border-radius:20px;cursor:pointer;font-size:14px}
.dark-mode-toggle:hover{background:rgba(255,255,255,0.3)}
.header{position:relative}
.mode-selector{display:flex;gap:10px;margin-bottom:15px}
.mode-btn{flex:1;padding:12px;border:2px solid #e0e0e0;border-radius:10px;background:white;cursor:pointer;text-align:center;transition:all 0.2s}
.mode-btn:hover,.mode-btn.selected{border-color:#667eea;background:#f8f9ff}
.mode-btn h3{font-size:16px;color:#667eea;margin-bottom:4px}
.mode-btn p{font-size:12px;color:#666}
.dark-mode .mode-btn{background:#2d3548;border-color:#3d4558;color:#e0e0e0}
.dark-mode .mode-btn.selected{background:#353d54}

/* ===== NUEVAS FUNCIONALIDADES ===== */

/* Temporizador por pregunta */
.qtimer-bar{height:6px;background:#e0e0e0;border-radius:3px;margin-bottom:12px;overflow:hidden}
.qtimer-fill{height:100%;border-radius:3px;transition:width 1s linear;background:linear-gradient(90deg,#10b981,#667eea)}
.qtimer-fill.warning{background:linear-gradient(90deg,#f59e0b,#ef4444)}
.qtimer-label{font-size:12px;color:#667eea;font-weight:600;text-align:right;margin-bottom:4px}
.dark-mode .qtimer-bar{background:#3d4558}

/* Filtro por tema */
.topic-filter{margin-top:10px}
.topic-select{width:100%;padding:10px;border:2px solid #e0e0e0;border-radius:8px;font-size:14px;background:white;cursor:pointer}
.topic-select:focus{outline:none;border-color:#667eea}
.dark-mode .topic-select{background:#2d3548;border-color:#3d4558;color:#e0e0e0}

/* Modo Flashcard */
.flashcard-container{perspective:1000px;margin:20px 0}
.flashcard{width:100%;min-height:220px;position:relative;transform-style:preserve-3d;transition:transform 0.6s;cursor:pointer}
.flashcard.flipped{transform:rotateY(180deg)}
.flashcard-front,.flashcard-back{position:absolute;width:100%;min-height:220px;backface-visibility:hidden;border-radius:16px;padding:30px;display:flex;flex-direction:column;justify-content:center;align-items:center;text-align:center}
.flashcard-front{background:linear-gradient(135deg,#667eea,#764ba2);color:white;font-size:18px;font-weight:600;line-height:1.5}
.flashcard-back{background:white;border:3px solid #10b981;color:#065f46;transform:rotateY(180deg)}
.dark-mode .flashcard-back{background:#252b42;border-color:#10b981;color:#6ee7b7}
.flashcard-hint{font-size:12px;opacity:0.7;margin-top:12px}
.fc-controls{display:flex;gap:12px;justify-content:center;margin-top:15px;flex-wrap:wrap}
.btn-fc{padding:10px 22px;border:none;border-radius:10px;font-size:14px;font-weight:600;cursor:pointer;transition:all 0.2s}
.btn-fc-knew{background:#10b981;color:white}
.btn-fc-review{background:#ef4444;color:white}
.btn-fc-skip{background:#6b7280;color:white}
.btn-fc-flip{background:linear-gradient(135deg,#667eea,#764ba2);color:white}

/* Modo Simulacro */
.simulacro-badge{background:#ef4444;color:white;padding:4px 10px;border-radius:20px;font-size:12px;font-weight:700;margin-left:8px}

/* Exportar PDF */
.export-btn{background:#8b5cf6;color:white}
.export-btn:hover{background:#7c3aed}

</style>
</head>
<body>
<div class="container">
<div class="header">
<button class="dark-mode-toggle" onclick="toggleDarkMode()">üåô Modo Oscuro</button>
<h1>üìö Oracle 1z0-133 Quiz COMPLETO</h1>
<p>WebLogic Server 12c: Administration I - Edici√≥n Completa</p>
<p style="margin-top:12px;font-size:22px;font-weight:900;letter-spacing:3px;text-transform:uppercase;background:linear-gradient(90deg,#ffd700,#ff6b6b,#ffd700);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;text-shadow:none;animation:shimmer 2s infinite">üë§ EDGAR PINTO MATUMINY</p>
<style>
@keyframes shimmer{0%{background-position:0% 50%}50%{background-position:100% 50%}100%{background-position:0% 50%}}
p[style*="EDGAR"]{background-size:200% auto}
</style>
</div>

<div class="config-panel" id="configPanel">
<h2 style="color:#667eea;margin-bottom:15px">Selecciona el Modo de Estudio</h2>
<div class="mode-selector">
<div class="mode-btn selected" onclick="selectMode('practice',event)"><h3>üìñ Pr√°ctica Normal</h3><p>Estudia a tu ritmo, revisa respuestas</p></div>
<div class="mode-btn" onclick="selectMode('exam',event)"><h3>‚è±Ô∏è Modo Examen</h3><p>Cron√≥metro, sin retroceder</p></div>
<div class="mode-btn" onclick="selectMode('flashcard',event)"><h3>üÉè Flashcards</h3><p>Memoriza volteando tarjetas</p></div>
<div class="mode-btn" onclick="selectMode('simulacro',event)"><h3>üéØ Simulacro Real</h3><p>70 preguntas, 105 min como el examen</p></div>
</div>
<div class="config-row">
<div class="config-group">
<label class="config-label">Pregunta Inicial:</label>
<input type="number" id="startQuestion" class="config-input" min="1" max="127" value="1" placeholder="1">
</div>
<div class="config-group">
<label class="config-label">Pregunta Final:</label>
<input type="number" id="endQuestion" class="config-input" min="1" max="127" value="127" placeholder="127">
</div>
<div class="config-group">
<label class="config-label">Opciones de Aleatorizaci√≥n:</label>
<div class="checkbox-container">
<input type="checkbox" id="randomOrder">
<label for="randomOrder">Orden Aleatorio de Preguntas</label>
</div>
<div class="checkbox-container" style="margin-top:8px">
<input type="checkbox" id="randomAnswers">
<label for="randomAnswers">Orden Aleatorio de Respuestas</label>
</div>
</div>
<div class="config-group">
<label class="config-label">Filtros Especiales:</label>
<div class="checkbox-container">
<input type="checkbox" id="onlyIncorrect">
<label for="onlyIncorrect">üìï Solo Preguntas Incorrectas Anteriores</label>
</div>
<div class="checkbox-container" style="margin-top:8px">
<input type="checkbox" id="onlyBookmarked">
<label for="onlyBookmarked">‚≠ê Solo Preguntas Marcadas</label>
</div>
<div class="checkbox-container" style="margin-top:8px">
<input type="checkbox" id="useQTimer">
<label for="useQTimer">‚è±Ô∏è Temporizador por Pregunta (90s)</label>
</div>
</div>
<div class="config-group topic-filter">
<label class="config-label">üè∑Ô∏è Filtrar por Tema:</label>
<select id="topicFilter" class="topic-select">
<option value="all">üìö Todos los temas</option>
<option value="cluster">üîó Clusters</option>
<option value="node">üñ•Ô∏è Node Manager</option>
<option value="jdbc">üóÑÔ∏è JDBC / Data Sources</option>
<option value="security">üîí Seguridad</option>
<option value="deploy">üöÄ Deployment</option>
<option value="domain">üèóÔ∏è Dominios y Configuraci√≥n</option>
<option value="monitor">üìä Monitorizaci√≥n y Diagn√≥stico</option>
<option value="jvm">‚òï JVM y Rendimiento</option>
</select>
</div>
</div>
<div class="config-row" id="startButtons">
<button class="btn-config" onclick="startQuiz(false)">üöÄ Iniciar de Cero</button>
<button class="btn-config" id="continueBtn" onclick="restoreSession()" style="background:#10b981;display:none">‚ñ∂Ô∏è Continuar donde qued√©</button>
<button class="btn-config" onclick="resetProgress()" style="background:#ef4444">üóëÔ∏è Borrar Progreso Guardado</button>
<button class="btn-config" onclick="viewStats()" style="background:#3b82f6">üìä Ver Estad√≠sticas</button>
<button class="btn-config" onclick="quickReview()" style="background:#f59e0b">üéØ Repaso R√°pido</button>
<button class="btn-config" onclick="exportIncorrectasPDF()" style="background:#8b5cf6">üìÑ Exportar Incorrectas PDF</button>
</div>
<div class="info-message">
üíæ Tu progreso se guarda autom√°ticamente. Puedes actualizar la p√°gina sin perder tus respuestas.
</div>
</div>

<div class="progress-bar hidden" id="progressBar"><div class="progress-fill" id="progressFill"></div></div>
<div id="timerDisplay" class="hidden" style="background:#667eea;color:white;padding:15px;text-align:center;font-size:24px;font-weight:bold;letter-spacing:2px">‚è±Ô∏è 00:00:00</div>
<div class="quiz-content hidden" id="quizContent"></div>
</div>

<script>
const allQuestionsData=[
"Q1: Configuration Wizard - create domain with cluster of 3 managed servers and HTTP proxy. Which three steps? (Choose 3)|Create one cluster|Install Oracle HTTP Server|Create one Coherence server|Create four managed servers|Assign three servers to cluster|Specify proxy port for admin server|0,3,4",
"Q2: Use database to store WebLogic transaction logs for managed server. Which two steps required? (Choose 2)|Under managed server's Services config select 'JDBC' as type for transaction log store|Under managed server's Services config, select 'Disable Default Store'|Create non-XA data source in domain for database transaction log|Create XA data source in domain for database transaction log|0,2",
"Q3: Which session persistence type is invalid?|async_replicated|async_jdbc|replicated|async_memory|cookie|file|replicated_if_clustered|3",
"Q4: Administrator says no need to backup domain files on machine with only managed servers. Best explanation?|True because files can be re-created with pack/unpack utilities|True (with exception): if security realm uses embedded LDAP system|True (with exception): for applications deployed to managed server|Not true. Need to back up files using OS commands|0",
"Q5: Which statement is true about stopping Node Manager?|If stop Node Manager, managed servers it started also stop|You may kill Node Manager process using OS commands|Use stopNodeManager.sh script for graceful stop|Using admin console, select machine and click Stop|Admin server goes ADMIN mode if can't communicate with Node Manager|Managed servers go ADMIN mode if can't communicate with Node Manager|1",
"Q6: Configure data source with non-XA driver. Will participate in global transactions with EJB, selected 'Supports Global Transactions' and One-phase commit. Why wrong?|Must choose XA driver when data source participates in global transactions|'One Phase Commit' always returns 'ready' during phase one, may have heuristic errors|'One-Phase Commit' processes last, if EJB must go last, cannot use this|'One-Phase Commit' only allows data source in global transaction, cannot have global transaction with EJB|3",
"Q7: Creating dynamic cluster - options for distributing servers across machines. Three supported configurations? (Choose 3)|Use single machine|Use all machines in subnet|Use all machines in domain|Use percentage of machines in domain|Use machines matching expression|0,2,4",
"Q8: Action to automatically backup domain configuration when anyone activates configuration change?|Use backup='true' parameter of activate() in WLST|Admin console, select 'Follow Configuration changes' in Shared Preferences|Admin console, select 'Configuration Archive Enabled' under general configuration|Enabling automatic config creates backups during boot, not at activation|2",
"Q9: Best solution for handling frequently increasing loads when capacity exceeded?|Add third cluster, spread existing instances|Modify proxy load balancing to weight based|Configure dynamic clusters, specify anticipated server instances|Tune work managers|Replace software load balancer with hardware|2",
"Q10: How change admin console preferences for all admins to disable inline help?|Nothing you can do, inline help cannot be disabled|Nothing for all users, must be done per user|Log into admin console, disable inline help under 'help'|Access WLST, use EnableInlineHelp(false)|2",
"Q11: Install WebLogic using JAR installer in silent mode. Two ways to create response file? (Choose 2)|Install/deinstall graphically, option to save response file|Use sample response file in documentation as template|Run Repository Creation Utility, option to save response file|Response file not required, answer interactively|JAR installer has no silent mode|0,1",
"Q12: Domain has 30 servers. Quickest way to identify servers in Failed health state?|Use Filter button from domain's Monitoring > Health tab|Use Monitoring > Health tab for each server|Write custom WLST script|Capture diagnostic snapshot|0",
"Q13: Java Node Manager configuration - stop servers with custom script mystopit.sh, restart on hardware crash, use SSL, check health every second. Which config correct?|StopScriptEnabled=true, StopScriptName=mystopit.sh, CrashRestartEnabled=true, SecureListener=true, StateCheckInterval=1|StopScriptEnabled=true, StopScriptName=mystopit.sh, CrashRecoveryEnabled=true, SecureListener=SSL, StateCheckInterval=1000|StopScriptEnabled=true, StopScriptName=mystopit.sh, CrashRestartEnabled=true, SecureListener=true, StateCheckInterval=1000|StopScript=true, StopScriptName=mystopit.sh, CrashRecoveryEnabled=true, SecureListener=true, StateCheckInterval=1000|StopScriptEnabled=true, StopScriptName=mystopit.sh, CrashRecoveryEnabled=true, SecureListener=true, StateCheckInterval=1000|4",
"Q14: Three statements true about WebLogic clusters? (Choose 3)|Clusters provide transparent failover|EJB apps can target entire cluster|All members must bind to same port|Members replicate data using heartbeats|Members can be in multiple domains|Web apps require proxy in cluster|0,1,5",
"Q15: Using WLDF Instrumentation, Dye Injection enabled. Know diagnostic context ID. Looking through server log. Which true?|Need Events Data Archive. Server logs don't contain WLDF context IDs|Need Harvested Data Archive. Server logs don't contain WLDF IDs|Need domain log file. Only domain log has WLDF IDs|Can search server log for context ID. Messages written during request contain ID|Need to translate context ID to transaction ID|0",
"Q16: Deploying inventory.war, State 'Prepared', targeted to managed1. Context root /inventory, start page index.jsp. Test before user access. Admin console: select inventory.war, Start and 'Servicing only admin requests'. Browser: enter host:port followed by /inventory/index.jsp. Which host:port?|managed1 host and port|Admin Server host and port|managed1 host and Administration port|Admin Server host and Administration port|2",
"Q17: Creating cluster using admin console. Which two statements true? (Choose 2)|All servers must be created before cluster created|Must pick cluster messaging mode|Non-dynamic cluster can change to dynamic later|Once created, cannot change messaging mode|Console doesn't provide way to manually migrate singleton services|1,2",
"Q18: Managed Server throws OutOfMemory errors. Want to dump heap when OOM thrown. How modify Java HotSpot startup to save dump in D:\\hprof-dumps\\?|Add -XX:+DumpHeapOnOutOfMemory -XX:DumpPath=D:\\hprof-dumps|Add -XX:+HeapDumpOnOutOfMemoryError -XX:HeapDumpPath=D:\\hprof-dumps|Add -XX:+DumpHeapOnOutOfMemoryError -XX:HeapPath=D:\\hprof-dump|Add -XX:+HeapDumpOnOutOfMemory -XX:HeapDumpPath=D:\\hprof-dumps|Add -XX:+HeapDumpOnOutOfMemoryError -XX:DumpPath=D:\\hprof-dumps|Add -XX:+HeapDumpOnOutOfMemoryException -XX:HeapDumpPath=D:\\hprof-dumps|1",
"Q19: Admin Console monitoring resource. Three techniques to customize output? (Choose 3)|Sort rows by specific column|Limit number of rows displayed|Change order of displayed columns|View rows from specific time range|Combine multiple columns|0,1,2",
"Q20: Software company with C++/.NET objects, many COM components. Deployed WebLogic Server12c. Want to use prebuilt COM objects. Need interim solution before web services. Which artifact helps?|Messaging Bridge|IDL Mapper|jCOM|XMLRegistry|COM2Java|4"
];

// Preguntas 21-50
allQuestionsData.push(...[
"Q21: Application uses generic JDBC data source. Network connection not 100% reliable. Two data source attributes to avoid failures? (Choose 2)|Statement Cache Type|Pool Reserve Mode|Test Table Name|Test Connection Mode|Test Connections on Reserve|2,4",
"Q22: Three tasks Node Manager can perform? (Choose 3)|Start a server|Define new server|Host Node Manager console|Automatically restart failed server|Kill failed application|Kill server process that didn't shut down properly|0,3,4",
"Q23: Created shutdown class MyClass to execute before server shutdown. Which true regarding MyClass?|Can be specified in Configuration Wizard as shutdown class|Must be available in WebLogic Server's classpath|Can be targeted to only one server instance|Must not have main method|1",
"Q24: Existing nondynamic cluster hosting libraries, apps, data sources. Need to scale out with new server. Two ways to create new server? (Choose 2)|Use Configuration Wizard to add server to cluster|Use pack/unpack to copy existing server|Use Admin Console to add network channel to cluster|Use Admin Console to clone existing server in cluster|0,3",
"Q25: Take web app offline. Three options supported when stopping running app? (Choose 3)|Terminate HTTP sessions immediately|Terminate HTTP sessions after 3 minutes|Move HTTP sessions to database|Wait for HTTP sessions to timeout|Allow new requests only through admin port|Move in-progress requests to another server|0,3,4",
"Q26: Browser login to web app on WebLogic. Click 'publish', 'Access Denied' appears. Two statements true about security? (Choose 2)|App not associated with security roles|Security realms not configured|Your user account expired|Your user account exists in authentication provider|Security policy attached to 'publish' URL|3,4",
"Q27: Analyze HTTP session count and heap size over 6 hours. View both together. Three steps? (Choose 3)|Create custom view|Start JVM Runtime view|Drag each metric onto charts in same view|Access Monitoring Dashboard|Click application's Monitoring tab|2,3,4",
"Q28: App fails. Exception: JDBC data source cannot be found. Two steps to verify availability? (Choose 2)|Launch JDBCDiagnostics utility|Verify Dependencies attribute|View target server's JNDI tree|Verify app and data source have same target|2,3",
"Q29: Three statements true about proxy plug-ins behavior? (Choose 3)|Proxy pins client to server if session cookie created|Proxy fails over if connection/request times out|Proxy distributes requests based on CPU|Proxy dynamically learns cluster locations|Proxy always uses SSL|Proxy replicates session data|0,1,3",
"Q30: Domain has directory servers. Domain has managed1. When will managed1 directory be created?|When managed1 defined in Wizard|When domain created|When Admin Server comes up first time|When managed1 server comes up first time|3",
"Q31: Two metrics to monitor unicast in cluster? (Choose 2)|Groups|Master|Backup Server|Session Replicas|Local Group Leader|0,4",
"Q32: Startup fails: Address already in use. Two methods to identify what's listening? (Choose 2)|pmap lists processes with port|UNIX lsof reports on process at IP:port|netstat reports on process bound to IP:port|pstat reports detailed stats|Linux PortInfo raises alert|1,2",
"Q33: Dynamic cluster. Network admin requires all bind mycompany.com. Which action?|Use ${macro} in template's listen address|Assign each server separate machine|Create multiple templates|Update cluster's listen address prefix|0",
"Q34: Script startWebLogic.sh in root folder. What does this do?|Starts a machine|Starts Node Manager|Starts Managed server|Calls startWebLogic.sh in domain's bin|Calls startManagedWebLogic.sh|3",
"Q35: Multiple network channels. Each must have unique combination of two. Identify these two. (Choose 2)|Tunneling enabled|Listen address|Listen port|Outbound enabled|Channel weight|1,2",
"Q36: Two reasons for defining machines? (Choose 2)|Machine can be proxy|Machine definition required for Node Manager|To reference instance must know machine and port|Machine is required organizational unit|WebLogic uses assignments for session replication|Machine's Cluster Weight used by load balancers|1,4",
"Q37: Want transactions recoverable when nonclustered server crashes. Want default store. Which true?|Not possible. Must use JDBC store|Not possible. Must use clustered servers|Common, default config works|Before crash, update path to shared storage|After crash, obtain copy from admin server|3",
"Q38: Scale out cluster. Two mandatory changes? (Choose 2)|Create deployment plan|Create new machine|Create new server|Add server to cluster|Add server to machine|Add cluster to machine|1,2",
"Q39: Two true about upgrading to 12c? (Choose 2)|To use Wizard, current must be 9.0+|Upgrade Wizard no longer in 12.1.2|After wizard, reapply script customizations|Need to update admin files|1,2",
"Q40: Domain updated 10.3.6 to 12.1.12. Node Manager mode after update?|Nothing, runs same|In 'per machine' mode, nothing needed|In 'per domain' mode, requires manual steps to return to 'per machine'|Mode can be selected in Wizard|2",
"Q41: Three about patching using OPatch? (Choose 3)|Each patch has readme with instructions|Can use OPatch to see patches applied|OPatch is GUI, requires window manager|OPatch requires JDK|After installing, download OPatch|Each ZIP comes with OPatch|0,1,3",
"Q42: RDBMS Security Store Config. Three actions you can perform? (Choose 3)|Create tables in store|Execute SQL scripts in lib directory|Populate tables with external LDAP users|Test connection to database|Allocate tablespace|0,2,3",
"Q43: GridLink for RAC. Using FCF. Two true? (Choose 2)|Oracle Notification notifies of RAC changes|Reaction quick, FCF timeouts very low|FCF faster, polls and tests|FCF requires database server in GridLink|Can use any Oracle Thin driver|0,3",
"Q44: Use console to start managed. Three must be true? (Choose 3)|In config, server assigned to machine|Node Manager on admin machine|Node Manager on managed machine|Admin uses one-way SSL with Node Manager|In config, Node Manager configured for machine|Configured Java Node Manager|0,2,4",
"Q45: Two statements true about data sources? (Choose 2)|Targeted to domain|Bound in JNDI tree of server|Based on JMS specification|Contains connection pool|Domain requires at least one|1,3",
"Q46: Dynamic cluster. View inherited attributes for server2. How view all including inherited?|Use Console > 'server2' link|Use java weblogic.Deployer|Cannot, values not inherited|Use WLST|0",
"Q47: Web app in-memory replication across two buildings. Require replication within building. How implement?|Disable dynamic list in proxy|Configure cluster multicast|Configure cookies parameters|Configure each server's replication group|3",
"Q48: Configure for app updating multiple databases in same transaction. Which setting?|Enable Use XA Interface in properties|WebLogic supports by default|Split into multiple local|Configure with XA-compliant driver|Enable Two-Phase Commit in each|4",
"Q49: Performance test, OutOfMemory messages. How verify available heap?|Click Debug > Heap|Click Debug > Health|Click Monitoring > Health|Click Monitoring > Threads|Click Monitoring > Performance|4",
"Q50: Two auth providers ldap1 and ldap2. If succeeds ldap1 skip ldap2. If fails ldap1 must succeed ldap2. Control flag for ldap1?|Required|Requisite|Sufficient|Optional|2"
]);

// Preguntas 51-80
allQuestionsData.push(...[
"Q51: Planning deployment. Which is NOT valid decision?|Proxy plug-in or hardware load balancer|Configured or dynamic cluster|Replicated or persistent sessions|Unicast or multicast|Single or multiple domains|0",
"Q52: Shut down managed via console. Which always true?|Was on same machine as admin|Node Manager configured, running on managed machine|Can choose shut down now or after completes|Console calls WLST|2",
"Q53: New machine, two WLS 12.1.2 with different inventories. Which command determines differences?|None, inventories for databases only|ORACLE_HOME/wlserver/bin/compareInventory.sh|Oracle Inventory Viewer utility|ORACLE_HOME/oui/bin/compareInventory.sh|1",
"Q54: Creating domain. Select 'Manual Node Manager Setup'. What means?|Using Wizard for script-based|Wizard prompts to change defaults|Wizard bypasses all Node Manager Config|Using Wizard for Java-based|Must manually copy files to Node Manager home|4",
"Q55: Monitor HTTP session count. Three ways? (Choose 3)|Run jstat tool|Write custom WLST script|Use application's Monitoring tab|Use Monitoring Dashboard|Use Cloud Control page|1,2,3",
"Q56: Create Work Manager. Configure with Request Class. Three valid? (Choose 3)|Uniform Distribution Request Class|Response Time Request Class|Max Throughput Request Class|Fair Share Request Class|Context Request Class|1,3,4",
"Q57: Start managed1 in 'Standby' mode as backup. Which must be true?|managed1 must be of cluster|Domain has administration port|Only admin can start in Standby|No such thing as Standby mode|1",
"Q58: Require HA for sessions. Constraints: little memory, HA when multiple fail, can't update schema. Best option?|Database persistence|File persistence|In-memory replication|Whole-server migration|2",
"Q59: Partial log: <warning> <JDBC> <host01> <managed1> <Exception pool OracleDS1>. Two true? (Choose 2)|Server's name is OracleDS1|Server's machine is host01|Transaction ID is 001129|JDBC subsystem generated|User's identity is managed1|Severity is Critical|1,3",
"Q60: Configuring domain for order processing. Multiple JDBC in global transaction. One no XA driver. Which option?|Ignore Heuristics|Pinned to Thread|One Phase Commit|Logging Last Resource|Test Connections on Reserve|3",
"Q61: Which machines can be configured with Wizard?|machine and Windows machine|admin and managed machine|machine and UNIX machine|stand-alone and cluster machine|RDBMS and LDAP machine|2",
"Q62: Before viewing JVM performance, want JVM to garbage collect. How in console?|Cannot from console|In Monitoring > Performance, click Dump Stacks|In Monitoring > Threads, click Dump Stacks|In Monitoring > Performance, click Garbage Collect|In Monitoring > Performance, click GC|3",
"Q63: Certification matrix says 'application data access only'. Database cannot be used __________|By administration server|For internal data storage by WebLogic|By multidata source|In production environment|By Enterprise JavaBean|1",
"Q64: Three true about admin console? (Choose 3)|Console can be disabled|Context path may be changed|If Development Mode, no admin-level user needed|If Production Mode, must use secure port|If Administration Port enabled, must use only that port|0,1,4",
"Q65: Setting up GridLink. What function helps connect to dynamic RAC?|Simple Connection Access Node|Single Correlated Anonymous Network|Simple Connection Address Name|Single Client Access Name|3",
"Q66: File excerpt: <persistent-store-type>replicated</persistent-store-type>. From which file?|Weblogic-application.xml|Weblogic.xml|Session.xml|Config.xml|Web.xml|1",
"Q67: Two channels. X has higher Weight. Want to see if X used more. What assures X has higher rate?|X Bytes Sent higher|X Bytes Received higher|X Accept Count higher|X Connections higher|3",
"Q68: Existing data source to Oracle. Admin requests connections specify different username. Which attribute modify?|Properties|Credentials|Username|Login|URL|0",
"Q69: Admin Server fails. Before prepared backup. Recovery successful. Managed reconnect. Two true? (Choose 2)|Files available from same location|Backup was in Standby mode on different hardware|Must have shut down and restarted managed|Backup is any running managed server|Backup must be at same DNS/IP as original|1,4",
"Q70: Modify security realm. Delete default provider, add iplanet. Servers fail to start. Two causes? (Choose 2)|Weblogic user not in iplanet|Administrators group not in iplanet|Domain must include default provider|Iplanet not supported|LDAP can't be in default realm|0,1",
"Q71: Create Managed at 192.0.2.0:7100. Fails: can't bind. Another process on 192.0.2.0:7100. Many unused ports. Two true? (Choose 2)|Not WebLogic from this domain at that address|Is WebLogic running, others don't interfere|Change port to unused to resolve|Can't be admin, admins run on 7001|Because never started, no local config|Port can stay if another IP unused|2,5",
"Q72: Two true about multicast in cluster? (Choose 2)|Multicast for cluster heartbeats|Multicast replicates session state|Multiple clusters share same address|May disable on individual members|Multicast limited to single subnet|0,4",
"Q73: Three runtime metrics you can monitor? (Choose 3)|Average execution time for web URL|Number of transaction rollbacks|Maximum HTTP session timeout|Number of current EJB sessions|Numbers of faults for web service|Number of EJB instances|0,4,5",
"Q74: Zipped config before major changes. After changes, things fail. Want old config. Best action?|Undo manually using console or WLST|Stop admin, replace config, restart admin, stop managed, replace config, restart managed|Stop admin, extract only config.xml, overwrite, restart admin|Stop admin, replace config directory, restart admin|3",
"Q75: Several apps on managed. Compare completed requests. Quickest way?|Launch WLST viewAppRuntimes()|Access Dashboard, click Application Work Managers|Access Console, click Monitoring > Work Managers for each|Access Console, click Deployments|Run weblogic.Deployer with ‚Äìstatus|2",
"Q76: Online store. Users complain cart vanishes before completing. Which metric most relevant?|Average execution time|Session timeout|Current session count|High session count|Cookie domain|1",
"Q77: Troubleshooting transactions. Enough time phase one, not phase two. Timing out. Which attribute needs larger?|Timeout Seconds|Abandon Timeout Seconds|Before Completion Iteration Limit|Checkpoint Interval Seconds|Unregister Resource Grace Period|1",
"Q78: IT infrastructure with web and EJB. Each different workloads and requirements. Best solution?|Configure separate proxy for each|Configure dedicated WebLogic for each|Configure separate node manager for each|Configure separate cluster for each|0",
"Q79: Troubleshooting JTA. WebLogic extension provides which optional attribute to help troubleshoot?|a name|an ID|the status marked for rollback|a status|0",
"Q80: Restart failed stand-alone managed. Two true? (Choose 2)|Before restarting must use OS to kill old process|Managed can automatically restart on new hardware if migration setup|If started by Node Manager, can set to auto restart|If started by script, run script again|2,3"
]);

// Preguntas 81-110
allQuestionsData.push(...[
"Q81: Which tool creates managed server templates?|unpack|Configuration Wizard|Administration Console|WebLogic Scripting Tool (WLST)|appc|pack|5",
"Q82: In memory replication slow. Create replication channel. Two true? (Choose 2)|Channel for heartbeats so don't interfere|Each server must have this channel configured|If no channel, sessions persisted to file/database|Channel can be used for stateful session bean|Channel can't use secure protocol|1,3",
"Q83: Add new managed server. Three true? (Choose 3)|Server must be assigned machine|Server must be assigned listen port|Server's name can't change after created|Server can be associated with template|Servers can have duplicate names if unique ports|Server must be assigned listen address|0,1,5",
"Q84: Access Deployments page. web1 targeted to server1, in NEW state. Which true?|web1 available but never accessed|server1 in standby mode|server1 not running|web1 in process of being deployed to server1|3",
"Q85: Monitor transactions. Total count doesn't equal sum of committed and rolled back. How explain?|Total includes committed, rolled back, and heuristic|Total includes in-progress, others only completed|Total includes distributed and local, others distributed only|Total includes all since started, others latest log only|0",
"Q86: Create dynamic cluster: 2 servers, port 8101, calculated ports true. Which two ports? (Choose 2)|8101|8102|8103|8100|8104|0,3",
"Q87: Web app on single cluster. After in-memory replication, performance drop. Which improves performance while providing HA?|Configure asynchronous session replication|Increase session timeout|Configure file-based session persistence|Configure automatic service migration|Configure cookie-based session persistence|2",
"Q88: Three true about Change Center? (Choose 3)|Has link to view servers needing restart|In Development Mode, lock acquired automatically|Has link to view changes made so far|Locking prevents other users from taking lock|After activating changes, must always restart server|Available only in Production Mode|0,1,2",
"Q89: Three domain requirements with Configuration Wizard? (Choose 3)|Create Node Manager and enroll with domain|Create domain using custom template|Assign virtual IP addresses to all servers|Distribute domain files across multiple machines|Create dynamic cluster of five servers|0,1,3",
"Q90: Two advantages of SCAN when configuring GridLink? (Choose 2)|FCF pattern allowing rapid failure detection enabled|More sophisticated RLCB used; without SCAN reverts to round-robin|SCAN required for GridLink to use XA driver|Database URL shorter, one SCAN vs host:port for each RAC node|Data source config doesn't need updated when new nodes added to RAC|0,4",
"Q91: Apps will access cluster of redundant databases. Vendor other than Oracle. Want transparent failover. Which data source type?|generic data source|multi data source|GridLink data source|parallel data source|1",
"Q92: Two ways to start Java Node Manager on Linux? (Choose 2)|Use startNodeManager.sh script|Use console, select machine and click Start|Have Node Manager start at boot as daemon|Use Oracle OPMN to start as system process|Set environment, run Java VM with nodemanager.RunTime|0,1",
"Q93: App sends SQL. Today very slow. Thread dump shows socket operations. Initial assumption and action?|Max capacity reached, wait or increase|Response data larger than buffer, increase buffer|Activity on database side needs checked with DBA|Datasource connection leaked, needs reset|Firewall blocking, address with network admin|Oracle JDBC corrupted, needs reinstall|1",
"Q94: File excerpt: <persistent-store-type>replicated</persistent-store-type>. From which file?|weblogic-application.xml|session.xml|web.xml|config.xml|weblogic.xml|4",
"Q95: Admin down. One managed also down, has started before. Can't bring admin up yet, need managed. Run script, won't start. Explain?|Managed has disabled Managed Server Independence mode|Managed servers always contact admin for latest config|Managed must be part of cluster and cluster master down|Managed must reside on same machine as admin|Domain must use embedded LDAP, managed can't get updates|0",
"Q96: Java Node Manager can't start myserver. boot.properties corrupted. Know if delete, will re-create. Where is file?|under domain in servers/myserver/nodemanager|under Node Manager home in myserver|under domain in servers/myserver/security|under domain in servers/myserver/data/nodemanager|under Node Manager home directory|3",
"Q97: Scale out to include new machine. Install WebLogic on new. Three steps required to create domain directory? (Choose 3)|Use Wizard to clone domain|Run pack tool on admin machine|Transfer installation certificate to admin machine|Transfer managed server template to new machine|Use Console to clone admin server|Run unpack tool on new machine|1,3,5",
"Q98: Developers created POJOs in JAR. Make accessible from all apps on managed servers. Four ways? (Choose 4)|Include JAR as optional package|Deploy JAR as EJB|Deploy JAR as shared library|Place JAR in lib folder of domain|Deploy JAR to admin, all managed have access|Add JAR to CLASSPATH by editing setDomainEnv.sh|Deploy JAR as another web app|Deploy JAR as web service|1,2,4,7",
"Q99: Admin files backed up using tar. Admin crashes, files corrupted. Restored from backup. Try start with script. Doesn't run. Error: permission denied. How troubleshoot?|Check ownership and file system permissions of start script|Ensure logged in as WebLogic admin before running|Stop running managed then start admin|After restoration, must start admin using WLST|Be sure to start admin as root user|0",
"Q100: Three Console tasks require config lock of production domain? (Choose 3)|Stop application deployment|Create new JDBC data source|Change server's listen port|Suspend a running server|Add server to existing cluster|Create new administrative user|3,4,5",
"Q101: App comprising web and EJB. Two benefits of multitier over single-tier? (Choose 2)|Dynamic clusters only supported for multitier|Remote EJB access is blocked|Each cluster can be scaled independently|Future web clusters can share same EJB tier|All servers can be managed together|3,4",
"Q102: Data source Inactive Timeout 60 seconds. Suspect app not returning connections. Which column confirms?|State|Active Connections Current Count|Connection Delay Time|Leaked Connection Count|Current Capacity|3",
"Q103: Run under 64-bit JVM. Edit setDomainEnv.sh: USER_MEM_ARGS='-Xms32meg ‚ÄìXmx150meg'. Try start, fails: Invalid initial heap size. Why?|Min heap for 64-bit is 64 Megabytes|For performance, min and max should be same|Parameter entered incorrectly. Correct: '-Xms32m ‚ÄìXmx150m'|Must enter memory values in Kilobytes|Parameter entered incorrectly. Correct: '-Xms:32meg ‚Äì Xmx:150meg'|2",
"Q104: Replacing domain as migration. New server needs previously created JDBC store with JMS messages. Two config requirements? (Choose 2)|In Persistent Stores, create JDBC store and select 'Use existing store'|New domain name needs same as old domain|Duplicate JMS and persistent store config in new domain|Storage needs file based not JDBC based|Set prefix for JDBC store table to domain name|0,4",
"Q105: Start managed by script. Fails. Message: 'boot identity not valid'. What do before running again?|Add option allowing servers started without credentials|Update credentials in boot identity file|Update credentials in start script|Create boot identity using admin console|Boot identity file doesn't exist. Create one.|1",
"Q106: Installing WebLogic for development, testing, production. Each has different scalability, performance, security requirements. How implement?|Create single domain with three clusters|Create single domain with three admin servers|Create single domain with three managed servers|Create three domains|2",
"Q107: Domain includes Node Manager home. One way to enroll is nmEnroll(). Two scenarios where don't need this? (Choose 2)|Node Manager on machine where domain created using Wizard|Create managed template using pack. Then create domain using unpack on new machine|Use console. Select machine, then Configuration and Node Manager tabs. Select 'Enroll with Domain.' Save|Use script enrollNodeManager.sh under WEBLOGIC_HOME in server/bin|0,2",
"Q108: Configuration Wizard has Node Manager option. Two true about using Wizard to configure? (Choose 2)|Required to enter username and password for accessing Node Manager|Allowed to choose location of Node Manager home|Can select either Java-based or script-based Node Manager|After Wizard creates domain, it automatically starts configured Node Manager|0,3",
"Q109: Over time logs increased to 500 MB. Three techniques to decrease size? (Choose 3)|Increase severity level|Redirect standard output to log|Increase rotation time|Create and use custom log filter|Decrease rotation file size|1,2,4",
"Q110: Using Embedded LDAP supplied by Oracle WebLogic. Three true? (Choose 3)|Embedded LDAP can be accessed by external LDAP viewer|Embedded LDAP can't be used in production environment|Embedded LDAP uses file system to store WebLogic security provider data|Embedded LDAP uses database to store WebLogic security provider data|Embedded LDAP can be used to store user, group, security roles and policies for WebLogic security providers|0,1,2"
]);

// Preguntas 111-127
allQuestionsData.push(...[
"Q111: Dev group supplied latest WAR. Copy over previous. Redeploy. Current users access older, new users access new. Explain?|Only possible if deployed to cluster|Possible if versioned using Production Redeployment|Not possible. When redeployed replaces old, all access new|Not possible. When redeployed all continue old. Once exit, all access new|1",
"Q112: Deployed app on 12c, deployment name different than expected. Which method takes precedence to override default name?|Define name in library's manifest file|Configure <module-name> element in web.xml|Run weblogic.Deployer with ‚Äìname option|Set computed name based on deployment source file|Set <application-name> element in application.xml|4",
"Q113: WebLogic Java EE app uses JDBC data source. Three steps developer typically writes code to perform? (Choose 3)|Test connection to verify database's availability|Add new connection to data source if none available|Close connection to return connection to data source|Request connection from data source|Look up data source using JNDI name|0,3,4",
"Q114: Two true statements about WebLogic's role in transaction management? (Choose 2)|You can configure WebLogic JTA properties at domain, cluster, and server level|WebLogic can act as transaction manager for multiple transactional resource managers during distributed transaction|WebLogic supports transactional work managers|Starting with WebLogic 12c, can create two kinds of clusters: 'standard' and new transactional|WebLogic supports transactional Enterprise Java Beans|0,2",
"Q115: Two characteristics of Reconfiguration Wizard? (Choose 2)|Can upgrade any domain created using WLS 9.2 and above|Reconfiguration Wizard allows you to change domain mode|Reconfiguration Wizard allows you to select different Java JDK|Reconfiguration Wizard does not allow reconfiguration of JDBC data sources|Can upgrade only domain running WLS 10.3.x or later|3,4",
"Q116: Using Configuration Wizard to create new domain, don't set Listen Address for admin and accept default. What is result?|Server startup fails|Server binds to localhost|Server prompts for address when started first time|Server attempts to bind to all network interfaces on host OS|1",
"Q117: Want to configure LDAP authentication provider. Three pieces of information must obtain from LDAP administrator? (Choose 3)|name attribute for user objects|connection pool maximum size|base DN for group objects|realm name|host name and port|2,3,4",
"Q118: Three capabilities of non-default LDAP authentication providers included in WebLogic? (Choose 3)|adding user to group|creating new group|changing user's password|validating user's password|creating new user|identifying groups for user|1,3,4",
"Q119: Using Configuration Wizard to create new domain hosting EJB app without cluster. Remote EJB clients can take advantage of load balancing and failover. However, proxy server exists between clients and new cluster. Which cluster attribute should modify to ensure external EJB clients routed correctly through proxy?|Messaging Mode|Cluster Address|Broadcast Channel|Replication Channel|Cluster Type|1",
"Q120: By monitoring CPU and RAM utilization, one member of cluster receiving much lower percentage of request load than other servers. Which Admin Console metric should examine to help determine if network problem is cause?|Primary session count|Drop out frequency|Migration basis|Health state|Current heap size|4",
"Q121: Two statements true about Log Filters? (Choose 2)|You don't have to lock configuration to create Log Filters|Log Filters are created at domain level|Admin console assists in creation of Log Filter expressions|You can apply Log Filter to server log, but not to standard out|1,2",
"Q122: Two statements true when Admin Server compared to Managed Server? (Choose 2)|Admin Server manages domain configuration|Domain must have at least one of each type of server|Admin Server keeps domain log, but Managed Server does not|Managed Server keeps server log, but Admin Server does not|Java EE apps deployed only to Managed Server|2,3",
"Q123: Multiple node domain. On admin server's node, edit setDomainEnv.sh in bin directory and add new JAR file to CLASSPATH. Stop and restart all three WebLogic Servers. Upon investigation, only apps deployed to one WebLogic Server can access JAR file code. How explain?|You must also set domain attribute 'CLASSPATH Discovery Enabled'|Each machine that hosts WebLogic Servers has its own domain directories. Script must be modified there as well|Only first server to receive new config from admin gets updated CLASSPATH|CLASSPATH not for app code. For internal WebLogic code. Only apps deployed to admin can access code through CLASSPATH|1",
"Q124: Monitor running JDBC data source with console and note: Current Capacity = 10, Current Capacity High Count = 20. Two plausible explanations? (Choose 2)|Workload was lower than now|Statement cache size is 20|Pool size has increased|Statement cache size is 10|Pool size has decreased|Workload was higher than now|4,5",
"Q125: Cluster of four servers: ServerA, ServerB, ServerC, ServerD. Cluster hosts web app, accessed using proxy plug-in. Web app configured to use in-memory session replication. User directed to ServerA. HTTP session established on ServerA, also replicated to ServerC, but ServerA subsequently fails. Which server will this user be redirected to?|ServerD|ServerB|none; user will receive error message|ServerC|any other available server|3",
"Q126: When creating dynamic cluster, multiple options for how dynamic servers distributed across machines. Three supported configurations? (Choose 3)|Use all machines in domain|Use machines whose names match expression|Use percentage of machines in domain|Use all machines in subnet|Use single machine|1,3,4",
"Q127: Domain defines four machines: host01, host02, host11, host12. Also defines dynamic cluster whose Machine Name Match Expression set to value 'host1*'. Which machines will be used to host servers in this dynamic cluster?|host01 and host11 only|host11 and host12 only|host11 only|all machines|the default machine of domain|host01 only|1"
]);

let allQuestions=allQuestionsData.map((q,i)=>{
  let parts=q.split('|');
  let correct=parts[parts.length-1].split(',').map(n=>parseInt(n));
  return{number:i+1,text:parts[0],options:parts.slice(1,parts.length-1),correct};
});

let questions=[],currentQuestion=0,answers={},checkedQuestions={},correctCount=0,incorrectCount=0,quizStarted=false;

// Cargar progreso guardado
function loadProgress(){
  const saved=localStorage.getItem('oracleQuizProgress');
  if(saved){
    const data=JSON.parse(saved);
    answers=data.answers||{};
    checkedQuestions=data.checkedQuestions||{};
    correctCount=data.correctCount||0;
    incorrectCount=data.incorrectCount||0;
    currentQuestion=data.currentQuestion||0;
    return true;
  }
  return false;
}

// Guardar progreso
function saveProgress(){
  const data={
    answers,
    checkedQuestions,
    correctCount,
    incorrectCount,
    currentQuestion,
    questionRange:{start:questions[0].number,end:questions[questions.length-1].number},
    isRandom:document.getElementById('randomOrder')?.checked||false,
    isRandomAnswers:document.getElementById('randomAnswers')?.checked||false,
    savedQuizMode:quizMode||'practice',
    savedExamMode:examMode||false,
    savedQuestionNumbers:questions.map(q=>q.number),
    quizActive:true
  };
  localStorage.setItem('oracleQuizProgress',JSON.stringify(data));
}

// Resetear progreso
function resetProgress(){
  if(confirm('¬øEst√°s seguro de que quieres borrar todo el progreso guardado?')){
    localStorage.removeItem('oracleQuizProgress');
    answers={};
    checkedQuestions={};
    correctCount=0;
    incorrectCount=0;
    currentQuestion=0;
    alert('‚úÖ Progreso borrado exitosamente');
    location.reload();
  }
}

// Iniciar quiz
function _baseStartQuiz(continueMode){
  const start=parseInt(document.getElementById('startQuestion').value);
  const end=parseInt(document.getElementById('endQuestion').value);
  const random=document.getElementById('randomOrder').checked;
  const randomAns=document.getElementById('randomAnswers').checked;
  
  if(start<1||start>127||end<1||end>127||start>end){
    alert('‚ö†Ô∏è Por favor ingresa un rango v√°lido (1-127)');
    return;
  }
  
  // Filtrar preguntas seg√∫n el rango
  questions=allQuestions.slice(start-1,end);
  
  // Aleatorizar preguntas si est√° activado
  if(random){
    questions=questions.sort(()=>Math.random()-0.5);
  }
  
  // Aleatorizar respuestas si est√° activado
  if(randomAns){
    questions=questions.map(q=>{
      const shuffled={...q};
      const combined=shuffled.options.map((opt,idx)=>({opt,idx,isCorrect:shuffled.correct.includes(idx)}));
      const shuffledCombined=combined.sort(()=>Math.random()-0.5);
      shuffled.options=shuffledCombined.map(item=>item.opt);
      shuffled.correct=shuffledCombined.map((item,newIdx)=>item.isCorrect?newIdx:-1).filter(i=>i!==-1);
      shuffled.originalOrder=shuffledCombined.map(item=>item.idx);
      return shuffled;
    });
  }
  
  // Ocultar panel de configuraci√≥n y mostrar quiz
  document.getElementById('configPanel').classList.add('hidden');
  document.getElementById('progressBar').classList.remove('hidden');
  document.getElementById('quizContent').classList.remove('hidden');
  
  quizStarted=true;
  currentQuestion=0;
  
  // Si es modo continuar y hay progreso, cargarlo
  if(continueMode){
    loadProgress();
  }else{
    // Iniciar de cero
    answers={};
    checkedQuestions={};
    correctCount=0;
    incorrectCount=0;
  }
  
  loadQuestion();
}

function _baseLoadquestion(){
  const question=questions[currentQuestion];
  const questionId=question.number;
  const isChecked=checkedQuestions[questionId];
  const userAnswer=answers[questionId];
  
  // Obtener el rango seleccionado
  const rangeStart=questions[0].number;
  const rangeEnd=questions[questions.length-1].number;
  const rangeText=`(Rango: ${rangeStart}-${rangeEnd})`;
  
  let optionsHTML='';
  question.options.forEach((option,index)=>{
    const letter=String.fromCharCode(65+index);
    let optionClass='option';
    if(userAnswer&&userAnswer.includes(index))optionClass+=' selected';
    if(isChecked){
      optionClass+=' disabled';
      if(question.correct.includes(index))optionClass+=' correct';
      else if(userAnswer&&userAnswer.includes(index))optionClass+=' incorrect';
    }
    const originalIndex=question.originalOrder?question.originalOrder[index]:index;
    const translation=getTranslation(question.number,'option');
    const translationText=translation[originalIndex]?`<div class="translation">${translation[originalIndex]}</div>`:'';
    optionsHTML+=`<div class="${optionClass}" onclick="selectOption(${index})"><span class="option-letter">${letter}</span>${option}${translationText}</div>`;
  });
  
  const scoreHTML=`<div class="score-board"><div class="score-item"><span class="score-label">Pregunta</span><span class="score-value">${currentQuestion+1}/${questions.length}</span></div><div class="score-item"><span class="score-label">Correctas</span><span class="score-value" style="color:#10b981;">${correctCount}</span></div><div class="score-item"><span class="score-label">Incorrectas</span><span class="score-value" style="color:#ef4444;">${incorrectCount}</span></div></div>`;
  
  let resultMessage='';
  if(isChecked){
    const isCorrect=userAnswer&&userAnswer.length===question.correct.length&&userAnswer.every(ans=>question.correct.includes(ans));
    if(isCorrect){
      resultMessage='<div class="result-message correct">‚úÖ ¬°Correcto! Excelente trabajo.</div>';
    }else{
      const correctLetters=question.correct.map(i=>String.fromCharCode(65+i)).join(', ');
      resultMessage=`<div class="result-message incorrect">‚ùå Incorrecto. La respuesta correcta es: ${correctLetters}</div>`;
    }
  }
  
  const html=`${scoreHTML}<div class="question-number">Pregunta ${question.number} ${rangeText}</div><div class="question-text">${question.text}<div class="translation">${getTranslation(question.number,'question')}</div></div><div class="options">${optionsHTML}</div>${resultMessage}<div class="controls"><button class="btn-prev" onclick="previousQuestion()" ${currentQuestion===0?'disabled':''}>‚Üê Anterior</button><button class="btn-back-home" onclick="backToHome()">üè† Volver al Inicio</button><button class="btn-check" onclick="checkAnswer()" ${isChecked||!userAnswer||userAnswer.length===0?'disabled':''}>Verificar</button><button class="btn-next" onclick="nextQuestion()">${currentQuestion===questions.length-1?'Resultados ‚Üí':'Siguiente ‚Üí'}</button></div>`;
  
  document.getElementById('quizContent').innerHTML=html;
  updateProgress();
  saveProgress();
}

function backToHome(){
  if(confirm('¬øVolver al inicio? Tu progreso se guardar√° autom√°ticamente.')){
    // Guardar progreso primero, luego marcar como inactivo
    saveProgress();
    const saved=localStorage.getItem('oracleQuizProgress');
    if(saved){
      const data=JSON.parse(saved);
      data.quizActive=false;
      localStorage.setItem('oracleQuizProgress',JSON.stringify(data));
    }
    document.getElementById('configPanel').classList.remove('hidden');
    document.getElementById('progressBar').classList.add('hidden');
    document.getElementById('quizContent').classList.add('hidden');
    quizStarted=false;
  }
}

function getTranslation(questionNum,type){
  const T={
    1:{q:"Asistente de config - crear dominio con cl√∫ster de 3 servidores y proxy HTTP. ¬øQu√© tres pasos?",o:["Crear un cl√∫ster","Instalar Oracle HTTP Server","Crear servidor Coherence","Crear cuatro servidores administrados","Asignar tres servidores al cl√∫ster","Especificar puerto proxy para servidor admin"]},
    2:{q:"Usar BD para almacenar logs de transacciones WebLogic. ¬øQu√© dos pasos?",o:["Seleccionar 'JDBC' como tipo de almac√©n en Servicios del servidor","Seleccionar 'Deshabilitar Almac√©n Predeterminado'","Crear origen de datos no-XA para log de transacciones","Crear origen de datos XA para log de transacciones"]},
    3:{q:"¬øQu√© tipo de persistencia de sesi√≥n NO es v√°lido?",o:["async_replicated","async_jdbc","replicado","async_memory","cookie","archivo","replicated_if_clustered"]},
    4:{q:"Admin dice que no necesita backup en m√°quina con solo servidores administrados. ¬øMejor explicaci√≥n?",o:["Verdadero: archivos se recrean con pack/unpack","Verdadero (excepci√≥n): si usa LDAP integrado","Verdadero (excepci√≥n): para apps desplegadas en servidor admin","Falso: necesita backup con comandos del SO"]},
    5:{q:"¬øQu√© afirmaci√≥n es verdadera sobre detener Node Manager?",o:["Si detiene NM, los servidores que inici√≥ tambi√©n se detienen","Puede eliminar el proceso NM con comandos del SO","Usar stopNodeManager.sh para detenci√≥n elegante","Usar consola admin, seleccionar m√°quina y clic en Detener","Admin entra en modo ADMIN si no se comunica con NM","Servidores administrados entran en modo ADMIN si no se comunican con NM"]},
    6:{q:"Origen de datos no-XA en transacciones globales con EJB y One-phase commit. ¬øPor qu√© incorrecto?",o:["Debe elegir driver XA para transacciones globales","One Phase Commit siempre devuelve 'listo', puede tener errores heur√≠sticos","One-Phase Commit procesa √∫ltimo; si EJB debe ir √∫ltimo, no se puede usar","One-Phase Commit solo permite este origen en transacci√≥n global, no con EJB"]},
    7:{q:"Cl√∫ster din√°mico - distribuir servidores entre m√°quinas. ¬øTres configuraciones soportadas?",o:["Usar una sola m√°quina","Usar todas las m√°quinas en subred","Usar todas las m√°quinas del dominio","Usar porcentaje de m√°quinas del dominio","Usar m√°quinas cuyo nombre coincida con expresi√≥n"]},
    8:{q:"¬øQu√© acci√≥n hace backup autom√°tico de configuraci√≥n al activar cambios?",o:["Usar backup='true' en activate() de WLST","Consola: seleccionar 'Seguir cambios de configuraci√≥n'","Consola: seleccionar 'Archivo de configuraci√≥n habilitado'","Config autom√°tica crea backups al arrancar, no al activar"]},
    9:{q:"¬øMejor soluci√≥n para manejar cargas crecientes que superan la capacidad?",o:["A√±adir tercer cl√∫ster y distribuir instancias","Modificar balanceo de carga del proxy a basado en peso","Configurar cl√∫steres din√°micos con instancias anticipadas","Ajustar gestores de trabajo","Reemplazar balanceador software por hardware"]},
    10:{q:"¬øC√≥mo deshabilitar ayuda en l√≠nea para todos los admins?",o:["No se puede deshabilitar","Solo se puede hacer por usuario","Iniciar sesi√≥n en consola y deshabilitar ayuda en l√≠nea","Usar WLST con EnableInlineHelp(false)"]},
    11:{q:"Instalar WebLogic con instalador JAR en modo silencioso. ¬øDos formas de crear archivo de respuesta?",o:["Instalar gr√°ficamente, guardar archivo de respuesta","Usar archivo de respuesta de ejemplo de la documentaci√≥n","Ejecutar Repository Creation Utility","No se requiere archivo de respuesta","El instalador JAR no tiene modo silencioso"]},
    12:{q:"Dominio con 30 servidores. ¬øForma m√°s r√°pida de identificar servidores en estado Failed?",o:["Usar bot√≥n Filter en pesta√±a Monitoring > Health del dominio","Ver pesta√±a Monitoring > Health de cada servidor","Escribir script WLST personalizado","Capturar snapshot de diagn√≥stico"]},
    13:{q:"Config Java Node Manager con script de parada, reinicio en crash, SSL y comprobaci√≥n cada segundo. ¬øConfig correcta?",o:["StopScriptEnabled=true, CrashRestartEnabled=true, SecureListener=true, StateCheckInterval=1","StopScriptEnabled=true, CrashRecoveryEnabled=true, SecureListener=SSL, StateCheckInterval=1000","StopScriptEnabled=true, CrashRestartEnabled=true, SecureListener=true, StateCheckInterval=1000","StopScript=true, CrashRecoveryEnabled=true, SecureListener=true, StateCheckInterval=1000","StopScriptEnabled=true, CrashRecoveryEnabled=true, SecureListener=true, StateCheckInterval=1000"]},
    14:{q:"¬øTres afirmaciones verdaderas sobre cl√∫steres WebLogic?",o:["Los cl√∫steres proporcionan failover transparente","Apps EJB pueden dirigirse a todo el cl√∫ster","Todos los miembros deben vincularse al mismo puerto","Los miembros replican datos mediante heartbeats","Los miembros pueden estar en m√∫ltiples dominios","Las apps web requieren proxy en el cl√∫ster"]},
    15:{q:"WLDF con Dye Injection. ¬øD√≥nde encontrar el ID de contexto diagn√≥stico?",o:["Necesitas Events Data Archive","Necesitas Harvested Data Archive","Necesitas el log del dominio","Puedes buscar el ID en el log del servidor","Necesitas traducir el ID de contexto a ID de transacci√≥n"]},
    16:{q:"Desplegar inventory.war en estado 'Prepared'. Probar antes de usuarios. ¬øQu√© host:port usar?",o:["Host y puerto de managed1","Host y puerto del Admin Server","Host y puerto de administraci√≥n de managed1","Host y puerto de administraci√≥n del Admin Server"]},
    17:{q:"Crear cl√∫ster con consola admin. ¬øDos afirmaciones verdaderas?",o:["Todos los servidores deben crearse antes del cl√∫ster","Hay que elegir modo de mensajer√≠a del cl√∫ster","Un cl√∫ster no din√°mico puede cambiar a din√°mico","Una vez creado, no se puede cambiar el modo de mensajer√≠a","La consola no permite migrar manualmente servicios singleton"]},
    18:{q:"Servidor administrado lanza OutOfMemory. ¬øC√≥mo guardar heap dump en D:\\hprof-dumps\\?",o:["-XX:+DumpHeapOnOutOfMemory -XX:DumpPath=D:\\hprof-dumps","-XX:+HeapDumpOnOutOfMemoryError -XX:HeapDumpPath=D:\\hprof-dumps","-XX:+DumpHeapOnOutOfMemoryError -XX:HeapPath=D:\\hprof-dump","-XX:+HeapDumpOnOutOfMemory -XX:HeapDumpPath=D:\\hprof-dumps","-XX:+HeapDumpOnOutOfMemoryError -XX:DumpPath=D:\\hprof-dumps","-XX:+HeapDumpOnOutOfMemoryException -XX:HeapDumpPath=D:\\hprof-dumps"]},
    19:{q:"Consola admin monitorizando recurso. ¬øTres t√©cnicas para personalizar la salida?",o:["Ordenar filas por columna espec√≠fica","Limitar n√∫mero de filas mostradas","Cambiar orden de columnas","Ver filas de rango de tiempo espec√≠fico","Combinar m√∫ltiples columnas"]},
    20:{q:"Empresa con objetos COM. ¬øQu√© artefacto WebLogic ayuda a usarlos?",o:["Messaging Bridge","IDL Mapper","jCOM","XMLRegistry","COM2Java"]},
    21:{q:"Origen de datos JDBC gen√©rico con red poco fiable. ¬øDos atributos para evitar fallos?",o:["Statement Cache Type","Pool Reserve Mode","Test Table Name","Test Connection Mode","Test Connections on Reserve"]},
    22:{q:"¬øTres tareas que puede realizar Node Manager?",o:["Iniciar un servidor","Definir nuevo servidor","Hospedar consola de Node Manager","Reiniciar autom√°ticamente servidor fallido","Matar aplicaci√≥n fallida","Matar proceso de servidor que no se apag√≥ correctamente"]},
    23:{q:"Creaste clase de apagado MyClass. ¬øQu√© es verdadero?",o:["Puede especificarse en el Asistente de Configuraci√≥n","Debe estar en el classpath de WebLogic Server","Solo puede dirigirse a una instancia de servidor","No debe tener m√©todo main"]},
    24:{q:"Cl√∫ster no din√°mico existente. ¬øDos formas de crear nuevo servidor?",o:["Usar Asistente de Configuraci√≥n","Usar pack/unpack para copiar servidor existente","Usar Consola para a√±adir canal de red al cl√∫ster","Usar Consola para clonar servidor existente del cl√∫ster"]},
    25:{q:"Poner app web offline. ¬øTres opciones soportadas al detener app?",o:["Terminar sesiones HTTP inmediatamente","Terminar sesiones HTTP tras 3 minutos","Mover sesiones HTTP a base de datos","Esperar a que las sesiones HTTP expiren","Permitir nuevas peticiones solo por puerto admin","Mover peticiones en curso a otro servidor"]},
    26:{q:"Login en app web. 'Acceso Denegado' al publicar. ¬øDos afirmaciones verdaderas?",o:["App no asociada con roles de seguridad","Reinos de seguridad no configurados","Tu cuenta de usuario expir√≥","Tu cuenta existe en el proveedor de autenticaci√≥n","Pol√≠tica de seguridad adjunta a la URL 'publicar'"]},
    27:{q:"Analizar sesiones HTTP y heap juntos. ¬øTres pasos?",o:["Crear vista personalizada","Iniciar vista JVM Runtime","Arrastrar cada m√©trica a gr√°ficas en la misma vista","Acceder al Dashboard de Monitorizaci√≥n","Hacer clic en pesta√±a Monitoring de la aplicaci√≥n"]},
    28:{q:"App falla: origen de datos JDBC no encontrado. ¬øDos pasos para verificar disponibilidad?",o:["Lanzar utilidad JDBCDiagnostics","Verificar atributo Dependencies","Ver √°rbol JNDI del servidor objetivo","Verificar que app y origen de datos tienen el mismo objetivo"]},
    29:{q:"¬øTres afirmaciones verdaderas sobre comportamiento de proxy plugins?",o:["El proxy ancla al cliente al servidor si se crea cookie de sesi√≥n","El proxy hace failover si expira la conexi√≥n","El proxy distribuye peticiones seg√∫n CPU","El proxy aprende din√°micamente las ubicaciones del cl√∫ster","El proxy siempre usa SSL","El proxy replica datos de sesi√≥n"]},
    30:{q:"¬øCu√°ndo se crea el directorio de managed1?",o:["Cuando managed1 se define en el Asistente","Cuando se crea el dominio","Cuando el Admin Server arranca por primera vez","Cuando managed1 arranca por primera vez"]},
    31:{q:"¬øDos m√©tricas para monitorizar unicast en cl√∫ster?",o:["Groups","Master","Backup Server","Session Replicas","Local Group Leader"]},
    32:{q:"Arranque falla: direcci√≥n ya en uso. ¬øDos m√©todos para identificar qu√© est√° escuchando?",o:["pmap lista procesos con puerto","lsof en UNIX informa sobre proceso en IP:puerto","netstat informa sobre proceso vinculado a IP:puerto","pstat da estad√≠sticas detalladas","PortInfo en Linux genera alerta"]},
    33:{q:"Cl√∫ster din√°mico. Admin de red requiere que todos usen mycompany.com. ¬øQu√© acci√≥n?",o:["Usar ${macro} en direcci√≥n de escucha de la plantilla","Asignar cada servidor a m√°quina separada","Crear m√∫ltiples plantillas","Actualizar prefijo de direcci√≥n de escucha del cl√∫ster"]},
    34:{q:"Script startWebLogic.sh en carpeta ra√≠z. ¬øQu√© hace?",o:["Inicia una m√°quina","Inicia Node Manager","Inicia servidor administrado","Llama a startWebLogic.sh en bin del dominio","Llama a startManagedWebLogic.sh"]},
    35:{q:"M√∫ltiples canales de red. Combinaci√≥n √∫nica de dos elementos. ¬øCu√°les?",o:["Tunneling habilitado","Direcci√≥n de escucha","Puerto de escucha","Salida habilitada","Peso del canal"]},
    36:{q:"¬øDos razones para definir m√°quinas?",o:["La m√°quina puede ser proxy","La definici√≥n de m√°quina es necesaria para Node Manager","Para referenciar instancia hay que conocer m√°quina y puerto","La m√°quina es unidad organizativa obligatoria","WebLogic usa asignaciones para replicaci√≥n de sesi√≥n","El peso del cl√∫ster de la m√°quina lo usan los balanceadores"]},
    37:{q:"Quieres transacciones recuperables cuando servidor no clusterizado falla. ¬øQu√© es verdadero?",o:["No es posible. Debes usar almac√©n JDBC","No es posible. Debes usar servidores clusterizados","Com√∫n, la configuraci√≥n por defecto funciona","Antes del crash, actualizar ruta a almacenamiento compartido","Despu√©s del crash, obtener copia del admin server"]},
    38:{q:"Escalar cl√∫ster. ¬øDos cambios obligatorios?",o:["Crear plan de despliegue","Crear nueva m√°quina","Crear nuevo servidor","A√±adir servidor al cl√∫ster","A√±adir servidor a m√°quina","A√±adir cl√∫ster a m√°quina"]},
    39:{q:"¬øDos afirmaciones verdaderas sobre actualizar a 12c?",o:["Para usar el Asistente, la versi√≥n actual debe ser 9.0+","El Asistente de Actualizaci√≥n ya no est√° en 12.1.2","Despu√©s del asistente, reaplicar personalizaciones de scripts","Hay que actualizar archivos admin"]},
    40:{q:"Dominio actualizado de 10.3.6 a 12.1.12. ¬øModo de Node Manager tras la actualizaci√≥n?",o:["Sin cambios, funciona igual","En modo 'por m√°quina', no se necesita nada","En modo 'por dominio', requiere pasos manuales para volver a 'por m√°quina'","El modo puede seleccionarse en el Asistente"]},
    41:{q:"¬øTres afirmaciones sobre parchear usando OPatch?",o:["Cada parche tiene readme con instrucciones","Se puede usar OPatch para ver parches aplicados","OPatch es GUI, requiere gestor de ventanas","OPatch requiere JDK","Despu√©s de instalar, descargar OPatch","Cada ZIP viene con OPatch"]},
    42:{q:"Configurar RDBMS Security Store. ¬øTres acciones posibles?",o:["Crear tablas en el almac√©n","Ejecutar scripts SQL en directorio lib","Poblar tablas con usuarios LDAP externos","Probar conexi√≥n a base de datos","Asignar tablespace"]},
    43:{q:"GridLink para RAC con FCF. ¬øDos afirmaciones verdaderas?",o:["Oracle Notification notifica cambios en RAC","FCF es r√°pido, los timeouts son muy bajos","FCF hace polling y pruebas","FCF requiere servidor de base de datos en GridLink","Se puede usar cualquier driver Oracle Thin"]},
    44:{q:"Usar consola para iniciar servidor administrado. ¬øTres condiciones necesarias?",o:["En config, servidor asignado a m√°quina","Node Manager en m√°quina del admin","Node Manager en m√°quina del servidor administrado","Admin usa SSL unidireccional con Node Manager","En config, Node Manager configurado para la m√°quina","Java Node Manager configurado"]},
    45:{q:"Servidor de producci√≥n necesita certificados SSL reales. ¬øQu√© herramienta usar?",o:["keytool de Java","openssl","Consola de Administraci√≥n WebLogic","Oracle Certificate Manager","Herramienta SSL de terceros"]},
    46:{q:"¬øDos afirmaciones verdaderas sobre despliegue staged vs. nostage?",o:["En staged, archivos se copian a cada servidor objetivo","En nostage, archivos se copian a cada servidor objetivo","Staged es el predeterminado","Nostage requiere almacenamiento compartido","En staged, el admin server mantiene la copia maestra"]},
    47:{q:"Pool de conexiones lleno y llega nueva petici√≥n. ¬øQu√© ocurre?",o:["La petici√≥n falla inmediatamente","La petici√≥n espera hasta que haya conexi√≥n disponible o expire timeout","Se crea nueva conexi√≥n aunque supere el m√°ximo","La petici√≥n se redirige a otro origen de datos","Se activa circuit breaker autom√°ticamente"]},
    48:{q:"¬øQu√© tipo de proveedor configurar para LDAP externo?",o:["DefaultAuthenticator","LDAPAuthenticator","ActiveDirectoryAuthenticator","OracleInternetDirectory","CustomLDAPAuthenticator"]},
    49:{q:"¬øQu√© herramienta captura datos de diagn√≥stico sin reiniciar el servidor?",o:["WLDF (WebLogic Diagnostic Framework)","JRockit Flight Recorder","Java Mission Control","VisualVM","JConsole"]},
    50:{q:"Quieres desplegar app sin interrumpir usuarios actuales. ¬øQu√© caracter√≠stica usar?",o:["Blue-green deployment","Production Redeployment","Parallel deployment","Rolling restart","Zero-downtime deployment"]},
    51:{q:"¬øD√≥nde se almacena la configuraci√≥n de seguridad del dominio?",o:["En config.xml del dominio","En el servidor LDAP integrado","En base de datos externa","En archivo security.xml","En el servidor admin √∫nicamente"]},
    52:{q:"¬øQu√© ocurre cuando Node Manager pierde conexi√≥n con el Admin Server?",o:["Node Manager se detiene inmediatamente","NM contin√∫a monitorizando y gestionando servidores locales","Todos los servidores administrados se detienen","NM intenta reconectar indefinidamente","NM entra en modo de solo lectura"]},
    53:{q:"¬øDiferencia entre origen de datos XA y no-XA?",o:["XA soporta transacciones distribuidas, no-XA no","No-XA es m√°s r√°pido para transacciones simples","XA requiere driver especial de Oracle","No-XA no soporta pool de conexiones","XA solo funciona con Oracle Database"]},
    54:{q:"¬øC√≥mo se configura SSL en WebLogic Server?",o:["Solo mediante archivos de configuraci√≥n XML","Mediante Consola de Administraci√≥n o WLST","Requiere reinicio completo del dominio","Solo durante la instalaci√≥n inicial","Solo mediante el Asistente de Configuraci√≥n"]},
    55:{q:"Cl√∫ster WebLogic. ¬øC√≥mo se elige el servidor primario para replicaci√≥n de sesi√≥n?",o:["Por n√∫mero de sesiones activas","Por carga de CPU","Por orden alfab√©tico del nombre","Aleatoriamente al crear la sesi√≥n","Por configuraci√≥n manual del admin"]},
    56:{q:"¬øQu√© es un plan de despliegue en WebLogic?",o:["Archivo que describe pasos de instalaci√≥n","Archivo XML que modifica descriptores de despliegue sin cambiar la app","Configuraci√≥n de rollback para despliegues fallidos","Script WLST para automatizar despliegues","Documento de planificaci√≥n de capacidad"]},
    57:{q:"¬øQu√© archivo de configuraci√≥n principal contiene la topolog√≠a del dominio?",o:["domain.xml","weblogic.xml","config.xml","topology.xml","server.xml"]},
    58:{q:"¬øCu√°ndo es necesario usar Node Manager?",o:["Siempre que se use WebLogic","Solo en entornos de producci√≥n","Cuando se necesita iniciar/parar servidores remotamente o reinicio autom√°tico","Solo cuando hay m√∫ltiples m√°quinas","Solo en modo cl√∫ster"]},
    59:{q:"¬øQu√© es un JDBC Store en WebLogic?",o:["Tipo de origen de datos para aplicaciones","Almac√©n persistente que usa BD para guardar mensajes JMS o logs de transacciones","Cache de consultas SQL","Pool de conexiones especializado","Tipo de origen de datos GridLink"]},
    60:{q:"¬øC√≥mo se configuran roles de seguridad en WebLogic?",o:["Solo en archivos de despliegue","Solo en la Consola de Administraci√≥n","En archivos de despliegue, Consola Admin o WLST","Solo durante el despliegue","En el archivo config.xml del dominio"]},
    61:{q:"¬øQu√© es el modo 'Admin' de un servidor WebLogic?",o:["Modo donde solo el admin puede iniciar sesi√≥n","Modo donde el servidor acepta solo peticiones administrativas","Modo de mantenimiento con funcionalidad reducida","Estado previo al inicio completo","Modo de depuraci√≥n con logging extra"]},
    62:{q:"¬øQu√© es la migraci√≥n de servicios singleton en un cl√∫ster?",o:["Mover una app de un servidor a otro","Trasladar autom√°ticamente un servicio √∫nico de servidor fallido a otro disponible","Migrar configuraci√≥n entre dominios","Copiar datos de sesi√≥n entre servidores","Actualizar un servidor sin interrupciones"]},
    63:{q:"¬øDiferencia entre Java Node Manager y Script Node Manager?",o:["Java NM es m√°s r√°pido","Script NM usa scripts del SO; Java NM es proceso Java independiente m√°s fiable","Java NM requiere JDK separado","Script NM solo funciona en Linux","Java NM solo funciona en Windows"]},
    64:{q:"¬øQu√© es el Configuration Archive en WebLogic?",o:["Backup manual del dominio","Historial autom√°tico de cambios de configuraci√≥n almacenado en ZIP","Exportaci√≥n del dominio para migraci√≥n","Log de auditor√≠a de cambios","Snapshot de rendimiento del dominio"]},
    65:{q:"¬øQu√© es Multi Data Source en WebLogic?",o:["Varios or√≠genes de datos en pool √∫nico para failover o balanceo de carga","Origen de datos con m√∫ltiples conexiones simult√°neas","Origen de datos que conecta a m√∫ltiples schemas","Configuraci√≥n JDBC para RAC de Oracle","Agrupaci√≥n de or√≠genes de datos por tema"]},
    66:{q:"¬øC√≥mo se implementa Single Sign-On (SSO) en WebLogic?",o:["Configurando m√∫ltiples reinos de seguridad","Usando proveedor de identidad SAML o Oracle Access Manager","Compartiendo cookies entre aplicaciones","Solo disponible con Oracle Identity Management","Configurando LDAP compartido entre dominios"]},
    67:{q:"¬øQu√© es el heartbeat en un cl√∫ster WebLogic?",o:["Mensaje peri√≥dico entre miembros para detectar fallos y mantener membres√≠a","M√©trica de rendimiento del servidor","Ping de comprobaci√≥n de conectividad","Log de estado del cl√∫ster","Se√±al de sincronizaci√≥n de configuraci√≥n"]},
    68:{q:"¬øDiferencia entre despliegue en cl√∫ster y en servidor individual?",o:["El despliegue en cl√∫ster requiere plan de despliegue","El cl√∫ster distribuye app a todos los miembros autom√°ticamente","El despliegue individual es m√°s fiable","No hay diferencia funcional","El cl√∫ster requiere reinicio para nuevos despliegues"]},
    69:{q:"¬øQu√© herramienta se usa para empaquetar y transferir dominios entre m√°quinas?",o:["zip/tar del SO","pack y unpack de WebLogic","Configuration Wizard","WLST con comandos export/import","Oracle Enterprise Manager"]},
    70:{q:"¬øCu√°ndo se usa modo 'per-domain' de Node Manager vs 'per-machine'?",o:["Per-domain es m√°s seguro","Per-domain gestiona m√∫ltiples dominios con un NM; per-machine gestiona todos los dominios de una m√°quina","Per-machine es la configuraci√≥n por defecto en 12c","No hay diferencia pr√°ctica","Per-domain requiere m√°s recursos"]},
    71:{q:"¬øQu√© es el Statement Cache en un origen de datos JDBC?",o:["Cache de resultados de consultas SQL","Cache de sentencias SQL preparadas para mejorar rendimiento","Buffer de conexiones pendientes","Log de sentencias SQL ejecutadas","Pool de transacciones activas"]},
    72:{q:"¬øQu√© es un Security Realm en WebLogic?",o:["Zona de red protegida","Contenedor de proveedores de seguridad que gestionan autenticaci√≥n y autorizaci√≥n","Certificado SSL del servidor","Pol√≠tica de seguridad del dominio","Grupo de usuarios con mismos permisos"]},
    73:{q:"¬øC√≥mo se actualizan apps en producci√≥n sin downtime?",o:["Reiniciando el cl√∫ster completo","Usando Production Redeployment con versiones de aplicaci√≥n","Deteniendo y reiniciando cada servidor individualmente","Solo es posible con downtime planificado","Usando el modo nostage autom√°ticamente"]},
    74:{q:"¬øQu√© es la replicaci√≥n de sesi√≥n en memoria en un cl√∫ster?",o:["Almacenar sesiones en base de datos compartida","Copiar datos de sesi√≥n HTTP a otro servidor del cl√∫ster para failover","Sincronizar sesiones entre dominios","Cache distribuido de sesiones","Backup peri√≥dico de sesiones a disco"]},
    75:{q:"¬øQu√© contiene el archivo boot.properties?",o:["Configuraci√≥n de arranque del JVM","Credenciales cifradas para arranque autom√°tico del servidor","Par√°metros de red del servidor","Lista de aplicaciones a desplegar al inicio","Configuraci√≥n de Node Manager"]},
    76:{q:"¬øQu√© ocurre si Node Manager no est√° disponible al iniciar servidor administrado?",o:["El servidor no puede iniciarse","Se puede iniciar manualmente con startManagedWebLogic.sh","El Admin Server intenta iniciarlo directamente","El servidor se inicia en modo degradado","Solo se puede iniciar si hay otro NM disponible"]},
    77:{q:"¬øQu√© es el Connection Pool en un origen de datos JDBC?",o:["Lista de consultas SQL precargadas","Conjunto de conexiones de BD mantenidas y reutilizadas para mejorar rendimiento","Buffer de transacciones pendientes","Cache de metadatos de tablas","Conjunto de credenciales de base de datos"]},
    78:{q:"¬øQu√© es un proveedor de autorizaci√≥n en WebLogic?",o:["Sistema que autentica usuarios","Sistema que determina qu√© recursos puede acceder un usuario autenticado","Proveedor de certificados SSL","Sistema de auditor√≠a de accesos","Gestor de sesiones de usuario"]},
    79:{q:"¬øQu√© significa que una app est√© en estado 'Prepared' en WebLogic?",o:["La app est√° lista para usuarios","La app est√° desplegada pero no activada; solo acepta peticiones administrativas","La app est√° en proceso de despliegue","La app tiene errores de validaci√≥n","La app est√° esperando recursos"]},
    80:{q:"¬øQu√© protocolo usa WebLogic para comunicaci√≥n entre miembros del cl√∫ster?",o:["HTTP/HTTPS","T3/T3S (protocolo propietario Oracle)","RMI sobre IIOP","UDP multicast","TCP directo entre pares"]},
    81:{q:"¬øQu√© es el Administration Port en WebLogic?",o:["Puerto del Admin Server para gestionar el dominio","Puerto SSL separado para tr√°fico administrativo exclusivo","Puerto de Node Manager","Puerto de comunicaci√≥n entre servidores del cl√∫ster","Puerto de la consola de administraci√≥n"]},
    82:{q:"¬øDiferencia entre reiniciar servidor con NM vs. con script?",o:["No hay diferencia","NM puede reiniciar autom√°ticamente tras crash y monitoriza el proceso; el script es manual","El script es m√°s r√°pido","NM requiere m√°s configuraci√≥n pero es menos fiable","El script puede reiniciar remotamente sin NM"]},
    83:{q:"¬øQu√© es el Inactive Connection Timeout en un pool JDBC?",o:["Tiempo m√°ximo de espera para obtener conexi√≥n","Tiempo tras el cual una conexi√≥n inactiva (leaked) se cierra","Tiempo de expiraci√≥n de transacciones","Tiempo de reconnect tras fallo de BD","Intervalo de prueba de conexiones"]},
    84:{q:"¬øC√≥mo se configuran pol√≠ticas de seguridad para URLs en WebLogic?",o:["Solo en web.xml","En web.xml, weblogic.xml o mediante la Consola","Solo mediante la Consola","Solo en deployment plan","En config.xml del dominio"]},
    85:{q:"¬øQu√© es el modo de despliegue 'external_stage'?",o:["Despliegue desde servidor externo","El admin copia archivos al stage; el servidor los usa desde all√≠ sin copiarlos","Despliegue desde repositorio externo","Modo para despliegues entre dominios","Despliegue con validaci√≥n externa previa"]},
    86:{q:"¬øQu√© es el Cluster Messaging y cu√°ndo elegir unicast vs. multicast?",o:["Comunicaci√≥n entre servidores; multicast es m√°s f√°cil, unicast es el predeterminado en 10.3.6+","Protocolo de replicaci√≥n de sesiones; son id√©nticos","Sistema de colas JMS del cl√∫ster; multicast requiere hardware especial","Sincronizaci√≥n de configuraci√≥n; unicast solo funciona en LAN","Mensajer√≠a entre aplicaciones; multicast es obligatorio en producci√≥n"]},
    87:{q:"¬øQu√© son los Work Managers en WebLogic?",o:["Gestores de tareas programadas","Mecanismo para priorizar y gestionar threads de trabajo seg√∫n reglas de negocio","Administradores de dominios","Gestores de pool de conexiones","Sistema de monitorizaci√≥n de carga"]},
    88:{q:"¬øPara qu√© sirve el archivo nodemanager.properties?",o:["Configurar propiedades del servidor administrado","Configurar el comportamiento de Node Manager: puertos, SSL, scripts, timeouts","Definir la topolog√≠a del dominio","Configurar el Admin Server","Especificar ubicaci√≥n de logs"]},
    89:{q:"¬øQu√© es el Test Connections on Reserve en un pool JDBC?",o:["Prueba todas las conexiones al arrancar","Prueba la conexi√≥n antes de d√°rsela a la aplicaci√≥n para asegurar que es v√°lida","Reserva conexiones para pruebas de carga","Monitoriza conexiones en segundo plano","Prueba autom√°tica tras fallo de base de datos"]},
    90:{q:"¬øDos ventajas de SCAN al configurar GridLink?",o:["Patr√≥n FCF que permite detecci√≥n r√°pida de fallos","Se usa RLCB m√°s sofisticado; sin SCAN revierte a round-robin","SCAN requerido para GridLink con driver XA","URL de base de datos m√°s corta: un SCAN vs host:puerto por nodo RAC","Config del origen no necesita actualizarse al a√±adir nodos RAC"]},
    91:{q:"Apps acceder√°n a cl√∫ster de BDs redundantes (proveedor no Oracle). ¬øQu√© tipo de origen de datos?",o:["Origen de datos gen√©rico","Origen de datos multi","Origen de datos GridLink","Origen de datos paralelo"]},
    92:{q:"¬øDos formas de iniciar Java Node Manager en Linux?",o:["Usar script startNodeManager.sh","Usar consola, seleccionar m√°quina y clic en Start","Hacer que NM arranque como daemon al inicio","Usar Oracle OPMN","Establecer entorno y ejecutar JVM con nodemanager.RunTime"]},
    93:{q:"App env√≠a SQL, hoy muy lenta. Thread dump muestra operaciones de socket. ¬øSuposici√≥n inicial?",o:["Capacidad m√°xima alcanzada","Datos de respuesta m√°s grandes que buffer, aumentar buffer","Actividad en la BD, consultar al DBA","Conexi√≥n del datasource con leak","Firewall bloqueando","JDBC de Oracle corrupto, reinstalar"]},
    94:{q:"Fragmento: <persistent-store-type>replicated</persistent-store-type>. ¬øDe qu√© archivo?",o:["weblogic-application.xml","session.xml","web.xml","config.xml","weblogic.xml"]},
    95:{q:"Admin ca√≠do. Servidor administrado no arranca con script. ¬øPor qu√©?",o:["El servidor tiene deshabilitado el modo de Independencia del Servidor Administrado","Los servidores administrados siempre contactan al admin para √∫ltima configuraci√≥n","El servidor debe ser parte de cl√∫ster y el master est√° ca√≠do","El servidor debe residir en la misma m√°quina que el admin","El dominio usa LDAP integrado, el servidor no puede obtener actualizaciones"]},
    96:{q:"Java Node Manager no puede iniciar myserver. boot.properties corrupto. ¬øD√≥nde est√° el archivo?",o:["Bajo el dominio en servers/myserver/nodemanager","Bajo el directorio home de NM en myserver","Bajo el dominio en servers/myserver/security","Bajo el dominio en servers/myserver/data/nodemanager","Bajo el directorio home de NM"]},
    97:{q:"Escalar a nueva m√°quina. Instalar WebLogic. ¬øTres pasos para crear directorio de dominio?",o:["Usar Asistente para clonar dominio","Ejecutar pack en m√°quina admin","Transferir certificado de instalaci√≥n a m√°quina admin","Transferir plantilla de servidor a nueva m√°quina","Usar Consola para clonar servidor admin","Ejecutar unpack en nueva m√°quina"]},
    98:{q:"Desarrolladores crearon POJOs en JAR. Hacerlo accesible desde todas las apps. ¬øCuatro formas?",o:["Incluir JAR como paquete opcional","Desplegar JAR como EJB","Desplegar JAR como librer√≠a compartida","Colocar JAR en carpeta lib del dominio","Desplegar JAR en admin","A√±adir JAR al CLASSPATH editando setDomainEnv.sh","Desplegar JAR como otra app web","Desplegar JAR como servicio web"]},
    99:{q:"Archivos admin restaurados desde backup. Script falla: 'permission denied'. ¬øC√≥mo resolver?",o:["Verificar propiedad y permisos del script de inicio","Asegurarse de iniciar sesi√≥n como admin de WebLogic","Detener servidores administrados y luego iniciar admin","Despu√©s de restauraci√≥n, iniciar admin con WLST","Iniciar admin como usuario root"]},
    100:{q:"¬øTres tareas de la Consola que requieren bloqueo de configuraci√≥n en producci√≥n?",o:["Detener despliegue de aplicaci√≥n","Crear nuevo origen de datos JDBC","Cambiar puerto de escucha del servidor","Suspender servidor en ejecuci√≥n","A√±adir servidor a cl√∫ster existente","Crear nuevo usuario administrativo"]},
    101:{q:"App con web y EJB. ¬øDos beneficios de multitier vs. single-tier?",o:["Los cl√∫steres din√°micos solo se soportan en multitier","El acceso remoto a EJB est√° bloqueado","Cada cl√∫ster puede escalarse independientemente","Futuros cl√∫steres web pueden compartir el mismo tier EJB","Todos los servidores pueden gestionarse juntos"]},
    102:{q:"Origen de datos con Inactive Timeout de 60s. Sospechas que la app no devuelve conexiones. ¬øQu√© columna lo confirma?",o:["State","Active Connections Current Count","Connection Delay Time","Leaked Connection Count","Current Capacity"]},
    103:{q:"JVM 64-bit. USER_MEM_ARGS='-Xms32meg ‚ÄìXmx150meg'. Al arrancar falla: 'Invalid initial heap size'. ¬øPor qu√©?",o:["El heap m√≠nimo para 64-bit es 64 Megabytes","Por rendimiento, m√≠nimo y m√°ximo deber√≠an ser iguales","Par√°metro incorrecto. Correcto: '-Xms32m ‚ÄìXmx150m'","Hay que introducir valores en Kilobytes","Par√°metro incorrecto. Correcto: '-Xms:32meg ‚Äì Xmx:150meg'"]},
    104:{q:"Nuevo servidor necesita almac√©n JDBC con mensajes JMS. ¬øDos requisitos de configuraci√≥n?",o:["En Persistent Stores, crear JDBC store y seleccionar 'Usar almac√©n existente'","Nuevo nombre de dominio igual al anterior","Duplicar config JMS y persistent store en nuevo dominio","Almacenamiento debe ser basado en archivo, no JDBC","Establecer prefijo de tabla JDBC store al nombre del dominio"]},
    105:{q:"Iniciar servidor administrado. Falla con 'boot identity not valid'. ¬øQu√© hacer?",o:["A√±adir opci√≥n para iniciar sin credenciales","Actualizar credenciales en boot identity file","Actualizar credenciales en script de inicio","Crear boot identity con consola admin","El archivo boot identity no existe. Crear uno."]},
    106:{q:"Instalar WebLogic para desarrollo, pruebas y producci√≥n con diferentes requisitos. ¬øC√≥mo implementar?",o:["Crear un dominio con tres cl√∫steres","Crear un dominio con tres admin servers","Crear un dominio con tres servidores administrados","Crear tres dominios"]},
    107:{q:"Dominio incluye home de NM. ¬øDos escenarios donde no es necesario nmEnroll()?",o:["NM en m√°quina donde se cre√≥ el dominio con el Asistente","Crear plantilla con pack, luego crear dominio con unpack en nueva m√°quina","Usar consola: seleccionar m√°quina, Config y pesta√±a NM","Usar script enrollNodeManager.sh"]},
    108:{q:"Asistente de Configuraci√≥n tiene opci√≥n de Node Manager. ¬øDos afirmaciones verdaderas?",o:["Hay que introducir usuario y contrase√±a para acceder a NM","Se puede elegir la ubicaci√≥n del home de NM","Se puede seleccionar NM basado en Java o en script","Tras el Asistente, inicia autom√°ticamente el NM configurado"]},
    109:{q:"Los logs aumentaron a 500 MB. ¬øTres t√©cnicas para reducir tama√±o?",o:["Aumentar nivel de severidad","Redirigir salida est√°ndar al log","Aumentar tiempo de rotaci√≥n","Crear y usar filtro de log personalizado","Disminuir tama√±o del archivo de rotaci√≥n"]},
    110:{q:"Usando LDAP Integrado de Oracle WebLogic. ¬øTres afirmaciones verdaderas?",o:["El LDAP integrado puede ser accedido por visores LDAP externos","El LDAP integrado no puede usarse en producci√≥n","El LDAP integrado usa sistema de archivos para almacenar datos de seguridad","El LDAP integrado usa base de datos","El LDAP integrado puede almacenar usuarios, grupos, roles y pol√≠ticas de seguridad"]},
    111:{q:"Redesplegar WAR. Usuarios actuales acceden al anterior, nuevos al nuevo. ¬øPor qu√©?",o:["Solo posible si desplegado en cl√∫ster","Posible si tiene versiones usando Production Redeployment","No es posible. Al redesplegar, reemplaza el anterior","No es posible. Todos contin√∫an con el anterior hasta salir"]},
    112:{q:"App desplegada en 12c con nombre diferente al esperado. ¬øQu√© m√©todo tiene precedencia?",o:["Definir nombre en manifest de la librer√≠a","Configurar <module-name> en web.xml","Ejecutar weblogic.Deployer con ‚Äìname","Nombre computado basado en archivo fuente","Elemento <application-name> en application.xml"]},
    113:{q:"App Java EE usa origen de datos JDBC. ¬øTres pasos que el desarrollador normalmente escribe?",o:["Probar conexi√≥n para verificar disponibilidad de la BD","A√±adir nueva conexi√≥n si no hay disponibles","Cerrar conexi√≥n para devolverla al pool","Solicitar conexi√≥n del origen de datos","Buscar origen de datos usando nombre JNDI"]},
    114:{q:"¬øDos afirmaciones verdaderas sobre el rol de WebLogic en gesti√≥n de transacciones?",o:["Puedes configurar propiedades JTA a nivel de dominio, cl√∫ster y servidor","WebLogic puede actuar como gestor de transacciones para m√∫ltiples recursos en transacci√≥n distribuida","WebLogic soporta work managers transaccionales","A partir de 12c, se pueden crear cl√∫steres 'est√°ndar' y 'transaccional'","WebLogic soporta Enterprise Java Beans transaccionales"]},
    115:{q:"¬øDos caracter√≠sticas del Reconfiguration Wizard?",o:["Puede actualizar cualquier dominio creado con WLS 9.2 y superior","Permite cambiar el modo del dominio","Permite seleccionar diferente JDK Java","No permite reconfigurar or√≠genes de datos JDBC","Solo puede actualizar dominios con WLS 10.3.x o posterior"]},
    116:{q:"Crear nuevo dominio sin configurar Listen Address para admin. ¬øQu√© resultado?",o:["El servidor falla al arrancar","El servidor se vincula a localhost","El servidor solicita direcci√≥n al primer arranque","El servidor intenta vincularse a todas las interfaces de red del SO"]},
    117:{q:"Configurar proveedor LDAP. ¬øTres datos necesarios del administrador LDAP?",o:["Atributo de nombre para objetos de usuario","Tama√±o m√°ximo del pool de conexiones","DN base para objetos de grupo","Nombre del realm","Nombre de host y puerto"]},
    118:{q:"¬øTres capacidades de proveedores LDAP no predeterminados en WebLogic?",o:["A√±adir usuario a grupo","Crear nuevo grupo","Cambiar contrase√±a del usuario","Validar contrase√±a del usuario","Crear nuevo usuario","Identificar grupos del usuario"]},
    119:{q:"Nuevo dominio con app EJB. Proxy entre clientes y cl√∫ster. ¬øQu√© atributo del cl√∫ster modificar?",o:["Messaging Mode","Cluster Address","Broadcast Channel","Replication Channel","Cluster Type"]},
    120:{q:"Un miembro del cl√∫ster recibe mucho menos carga. ¬øQu√© m√©trica de la Consola examinar para determinar si es problema de red?",o:["Primary session count","Drop out frequency","Migration basis","Health state","Current heap size"]},
    121:{q:"¬øDos afirmaciones verdaderas sobre Log Filters?",o:["No necesitas bloquear configuraci√≥n para crear Log Filters","Los Log Filters se crean a nivel de dominio","La consola admin ayuda a crear expresiones de Log Filter","Puedes aplicar Log Filter al log del servidor, pero no a la salida est√°ndar"]},
    122:{q:"¬øDos afirmaciones verdaderas comparando Admin Server con Managed Server?",o:["Admin Server gestiona la configuraci√≥n del dominio","El dominio debe tener al menos uno de cada tipo","Admin Server mantiene log del dominio, servidor administrado no","Servidor administrado mantiene log del servidor, Admin Server no","Apps Java EE solo se despliegan en servidores administrados"]},
    123:{q:"Editado setDomainEnv.sh en nodo del admin a√±adiendo JAR al CLASSPATH. Solo apps de un servidor acceden al JAR. ¬øPor qu√©?",o:["Debes establecer atributo 'CLASSPATH Discovery Enabled'","Cada m√°quina tiene sus propios directorios de dominio. El script debe modificarse all√≠ tambi√©n","Solo el primer servidor en recibir nueva config del admin obtiene CLASSPATH actualizado","CLASSPATH es para c√≥digo interno de WebLogic, no para apps"]},
    124:{q:"Current Capacity = 10, Current Capacity High Count = 20. ¬øDos explicaciones plausibles?",o:["La carga de trabajo era menor que ahora","El tama√±o del cache de sentencias es 20","El tama√±o del pool ha aumentado","El tama√±o del cache de sentencias es 10","El tama√±o del pool ha disminuido","La carga de trabajo era mayor que ahora"]},
    125:{q:"Cl√∫ster de cuatro servidores. Sesi√≥n en ServerA replicada en ServerC. ServerA falla. ¬øA qu√© servidor se redirige el usuario?",o:["ServerD","ServerB","Ninguno; el usuario recibir√° error","ServerC","Cualquier otro servidor disponible"]},
    126:{q:"Crear cl√∫ster din√°mico. ¬øTres configuraciones soportadas para distribuir servidores?",o:["Usar todas las m√°quinas del dominio","Usar m√°quinas cuyo nombre coincida con expresi√≥n","Usar porcentaje de m√°quinas del dominio","Usar todas las m√°quinas en subred","Usar una sola m√°quina"]},
    127:{q:"Dominio con Machine Name Match Expression='host1*'. ¬øQu√© m√°quinas se usar√°n (host01, host02, host11, host12)?",o:["host01 y host11 √∫nicamente","host11 y host12 √∫nicamente","host11 √∫nicamente","todas las m√°quinas","la m√°quina predeterminada del dominio","host01 √∫nicamente"]}
  };
  if(!T[questionNum])return type==='question'?'':[];
  if(type==='question')return T[questionNum].q||'';
  else if(type==='option')return T[questionNum].o||[];
  return'';
}

function selectOption(index){
  const question=questions[currentQuestion];
  const questionId=question.number;
  if(checkedQuestions[questionId])return;
  
  const isMultiple=question.correct.length>1;
  if(!answers[questionId])answers[questionId]=[];
  
  if(isMultiple){
    const answerIndex=answers[questionId].indexOf(index);
    if(answerIndex>-1)answers[questionId].splice(answerIndex,1);
    else answers[questionId].push(index);
  }else{
    answers[questionId]=[index];
  }
  
  loadQuestion();
}

function _baseCheckanswer(){
  const question=questions[currentQuestion];
  const questionId=question.number;
  const userAnswer=answers[questionId];
  
  if(!userAnswer||userAnswer.length===0)return;
  
  checkedQuestions[questionId]=true;
  
  const isCorrect=userAnswer.length===question.correct.length&&userAnswer.every(ans=>question.correct.includes(ans));
  if(isCorrect)correctCount++;
  else incorrectCount++;
  
  loadQuestion();
}

function _baseNextQuestionV12(){
  if(currentQuestion===questions.length-1)showResults();
  else{currentQuestion++;loadQuestion();}
}

function previousQuestion(){
  if(currentQuestion>0){currentQuestion--;loadQuestion();}
}

function updateProgress(){
  const progress=((currentQuestion+1)/questions.length)*100;
  document.getElementById('progressFill').style.width=progress+'%';
}

function _baseShowresults(){
  const percentage=Math.round((correctCount/questions.length)*100);
  let message='',emoji='';
  if(percentage>=90){message='¬°Excelente! Dominas el material.';emoji='üèÜ';}
  else if(percentage>=70){message='¬°Buen trabajo! Sigue estudiando.';emoji='üëç';}
  else if(percentage>=50){message='Bien, pero necesitas m√°s pr√°ctica.';emoji='üìö';}
  else{message='Sigue estudiando. ¬°T√∫ puedes!';emoji='üí™';}
  
  const html=`<div class="final-results"><div style="font-size:64px;margin-bottom:20px;">${emoji}</div><h2>Resultados Finales</h2><div class="final-score">${correctCount} / ${questions.length}</div><div style="font-size:32px;color:#667eea;margin:20px 0;">${percentage}%</div><p style="font-size:18px;color:#666;margin-bottom:30px;">${message}</p><div style="display:flex;justify-content:center;gap:30px;margin:30px 0;"><div><div style="color:#10b981;font-size:36px;font-weight:bold;">${correctCount}</div><div style="color:#666;">Correctas</div></div><div><div style="color:#ef4444;font-size:36px;font-weight:bold;">${incorrectCount}</div><div style="color:#666;">Incorrectas</div></div><div><div style="color:#6b7280;font-size:36px;font-weight:bold;">${questions.length-correctCount-incorrectCount}</div><div style="color:#666;">Sin responder</div></div></div><button class="restart-btn" onclick="restartQuiz()">üîÑ Reiniciar Quiz</button><button class="restart-btn" onclick="location.reload()" style="background:#6b7280;margin-left:10px">‚öôÔ∏è Nueva Configuraci√≥n</button></div>`;
  
  document.getElementById('quizContent').innerHTML=html;
  document.getElementById('progressFill').style.width='100%';
  
  // Limpiar progreso guardado al terminar
  localStorage.removeItem('oracleQuizProgress');
}

function restartQuiz(){
  currentQuestion=0;
  answers={};
  checkedQuestions={};
  correctCount=0;
  incorrectCount=0;
  localStorage.removeItem('oracleQuizProgress');
  loadQuestion();
}

// ==========================================
// NUEVAS FUNCIONALIDADES INTEGRADAS
// ==========================================
let quizMode='practice',examMode=false,timerInterval=null,startTime=null;
let currentStreak=0,bookmarkedQuestions=new Set(),historicallyIncorrect=new Set();
const shownAchievements=new Set();

function toggleDarkMode(){
  document.body.classList.toggle('dark-mode');
  const b=document.querySelector('.dark-mode-toggle');
  if(b)b.textContent=document.body.classList.contains('dark-mode')?'‚òÄÔ∏è Modo Claro':'üåô Modo Oscuro';
  localStorage.setItem('darkMode',document.body.classList.contains('dark-mode'));
}

function selectMode(mode,e){
  document.querySelectorAll('.mode-btn').forEach(b=>b.classList.remove('selected'));
  e.currentTarget.classList.add('selected');quizMode=mode;
}

function startTimer(){
  startTime=Date.now();
  timerInterval=setInterval(()=>{
    const e=Math.floor((Date.now()-startTime)/1000);
    const h=Math.floor(e/3600),m=Math.floor((e%3600)/60),s=e%60;
    const td=document.getElementById('timerDisplay');
    if(td)td.textContent='‚è±Ô∏è '+String(h).padStart(2,'0')+':'+String(m).padStart(2,'0')+':'+String(s).padStart(2,'0');
  },1000);
}

function stopTimer(){clearInterval(timerInterval);return startTime?Math.floor((Date.now()-startTime)/1000):0;}

function loadHistoricalData(){
  const s=localStorage.getItem('oracleQuizHistory');
  if(s){const d=JSON.parse(s);historicallyIncorrect=new Set(d.incorrect||[]);bookmarkedQuestions=new Set(d.bookmarked||[]);}
}

function saveHistoricalData(){
  localStorage.setItem('oracleQuizHistory',JSON.stringify({incorrect:Array.from(historicallyIncorrect),bookmarked:Array.from(bookmarkedQuestions)}));
}

function getAttemptHistory(){const s=localStorage.getItem('oracleQuizAttempts');return s?JSON.parse(s):[];}

function saveAttempt(score,total,time){
  const a=getAttemptHistory();
  a.push({date:new Date().toISOString(),score,total,percentage:Math.round((score/total)*100),timeSpent:time});
  localStorage.setItem('oracleQuizAttempts',JSON.stringify(a));
}

function saveNote(qNum){
  const text=document.getElementById('note-'+qNum)?.value||'';
  const notes=JSON.parse(localStorage.getItem('oracleQuizNotes')||'{}');
  notes[qNum]=text;localStorage.setItem('oracleQuizNotes',JSON.stringify(notes));
  showPopup('üìù Nota guardada','Tu apunte se guard√≥ correctamente');
}

function getNote(qNum){return JSON.parse(localStorage.getItem('oracleQuizNotes')||'{}')[qNum]||'';}

function updateDifficulty(qNum,ok){
  const h=JSON.parse(localStorage.getItem('oracleQuizDifficulty')||'{}');
  if(!h[qNum])h[qNum]={correct:0,total:0};
  h[qNum].total++;if(ok)h[qNum].correct++;
  localStorage.setItem('oracleQuizDifficulty',JSON.stringify(h));
}

function getDifficultyBadge(qNum){
  const d=JSON.parse(localStorage.getItem('oracleQuizDifficulty')||'{}')[qNum];if(!d)return'';
  const r=d.correct/d.total;
  if(r>=0.7)return'<span style="padding:2px 8px;border-radius:10px;font-size:10px;font-weight:700;background:#d1fae5;color:#065f46;margin-left:8px">üü¢ F√°cil</span>';
  if(r>=0.4)return'<span style="padding:2px 8px;border-radius:10px;font-size:10px;font-weight:700;background:#fef3c7;color:#92400e;margin-left:8px">üü° Media</span>';
  return'<span style="padding:2px 8px;border-radius:10px;font-size:10px;font-weight:700;background:#fee2e2;color:#991b1b;margin-left:8px">üî¥ Dif√≠cil</span>';
}

const ACHIEVEMENTS=[
  {id:'f1',icon:'ü•á',title:'¬°Primera Correcta!',desc:'Respondiste tu primera pregunta correctamente',check:(c,i,s)=>c===1&&i===0},
  {id:'s5',icon:'üî•',title:'¬°En Racha!',desc:'5 respuestas correctas seguidas',check:(c,i,s)=>s===5},
  {id:'s10',icon:'üí•',title:'¬°Imparable!',desc:'10 respuestas correctas seguidas',check:(c,i,s)=>s===10},
  {id:'p10',icon:'üíØ',title:'¬°Perfecto!',desc:'10 correctas sin ning√∫n error',check:(c,i,s)=>c===10&&i===0},
];

function checkAchievements(ok){
  if(ok)currentStreak++;else currentStreak=0;
  ACHIEVEMENTS.forEach(a=>{
    if(!shownAchievements.has(a.id)&&a.check(correctCount,incorrectCount,currentStreak)){
      shownAchievements.add(a.id);showPopup(a.icon+' '+a.title,a.desc);
    }
  });
}

function showPopup(title,desc){
  const old=document.querySelector('.ach-popup');if(old)old.remove();
  const p=document.createElement('div');p.className='ach-popup';
  p.style.cssText='position:fixed;top:20px;right:20px;background:linear-gradient(135deg,#667eea,#764ba2);color:white;padding:15px 20px;border-radius:12px;box-shadow:0 8px 25px rgba(0,0,0,0.3);z-index:9999;max-width:280px';
  p.innerHTML='<strong style="display:block;margin-bottom:4px">'+title+'</strong><span style="font-size:12px;opacity:0.9">'+desc+'</span>';
  document.body.appendChild(p);
  setTimeout(()=>{p.style.transition='opacity 0.5s';p.style.opacity='0';setTimeout(()=>p.remove(),500);},3000);
}

function getMotivation(){
  const msgs=['üí™ ¬°T√∫ puedes! Cada pregunta te acerca a tu certificaci√≥n.','üöÄ El √©xito est√° en la pr√°ctica constante.','üß† Entender es mejor que memorizar.','‚ö° ¬°La certificaci√≥n Oracle 1z0-133 te espera!','üéØ ¬°Cada error es una oportunidad de aprender!'];
  const a=getAttemptHistory();
  const days=a.length>0?Math.floor((Date.now()-new Date(a[0].date))/(86400000))+1:1;
  return'<div style="padding:10px 15px;border-radius:10px;margin-bottom:15px;text-align:center;font-weight:600;font-size:13px;background:#f0f4ff;color:#667eea;border:1px solid #c7d2fe">'+msgs[Math.floor(Math.random()*msgs.length)]+' | üìÖ D√≠a '+days+' de estudio</div>';
}

function toggleBookmark(qNum){
  if(bookmarkedQuestions.has(qNum))bookmarkedQuestions.delete(qNum);
  else bookmarkedQuestions.add(qNum);
  saveHistoricalData();loadQuestion();
}

function getProgressChart(){
  const a=getAttemptHistory();
  if(a.length<2)return'<p style="color:#888;padding:20px;text-align:center">Necesitas al menos 2 intentos para ver la gr√°fica üìà</p>';
  const last=a.slice(-10);const bw=Math.min(45,Math.floor(500/last.length));
  let bars='',labels='';
  last.forEach(x=>{
    const h=Math.round((x.percentage/100)*140);
    const c=x.percentage>=70?'#10b981':x.percentage>=50?'#f59e0b':'#ef4444';
    bars+='<div style="display:inline-block;height:'+h+'px;width:'+bw+'px;background:'+c+';border-radius:4px 4px 0 0;margin:0 3px;vertical-align:bottom" title="'+x.percentage+'%"></div>';
    labels+='<span style="display:inline-block;width:'+(bw+6)+'px;text-align:center;font-size:10px;color:#888">'+x.percentage+'%</span>';
  });
  return'<div style="width:100%;margin:15px 0"><div style="display:flex;align-items:flex-end;justify-content:center;height:150px;border-bottom:2px solid #e0e0e0;padding:0 10px">'+bars+'</div><div style="text-align:center;margin-top:5px">'+labels+'</div></div>';
}

function quickReview(){
  loadHistoricalData();
  const list=Array.from(historicallyIncorrect);
  if(list.length===0){alert('üéâ ¬°No tienes preguntas incorrectas! ¬°Excelente!');return;}
  let html='<div style="padding:30px"><div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:20px"><h2 style="color:#667eea">üéØ Repaso R√°pido</h2><button onclick="location.reload()" style="padding:10px 20px;background:#667eea;color:white;border:none;border-radius:8px;cursor:pointer;font-weight:600">‚Üê Volver</button></div><p style="color:#888;margin-bottom:20px">Tienes <strong>'+list.length+'</strong> preguntas incorrectas para repasar:</p>';
  list.forEach(n=>{
    const q=allQuestions.find(x=>x.number===n);if(!q)return;
    const ans=q.correct.map(i=>'<strong>'+String.fromCharCode(65+i)+')</strong> '+q.options[i]).join('<br>');
    html+='<div style="padding:20px;border-radius:12px;margin-bottom:15px;border-left:5px solid #ef4444;background:#fff5f5"><div style="font-size:14px;font-weight:600;margin-bottom:10px">P'+q.number+': '+q.text+'</div><div style="font-size:13px;color:#10b981;font-weight:600">‚úÖ Respuesta correcta:<br>'+ans+'</div></div>';
  });
  html+='</div>';
  document.getElementById('configPanel').classList.add('hidden');
  document.getElementById('progressBar').classList.add('hidden');
  document.getElementById('quizContent').classList.remove('hidden');
  document.getElementById('quizContent').innerHTML=html;
}

function viewStats(){
  loadHistoricalData();
  const a=getAttemptHistory();
  if(a.length===0){alert('üìä A√∫n no tienes intentos. ¬°Completa tu primer quiz!');return;}
  const avg=Math.round(a.reduce((s,x)=>s+x.percentage,0)/a.length);
  const best=Math.max(...a.map(x=>x.percentage));
  const worst=Math.min(...a.map(x=>x.percentage));
  let html='<div style="padding:40px;text-align:center"><h2 style="color:#667eea;margin-bottom:20px">üìä Estad√≠sticas Hist√≥ricas</h2><div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(120px,1fr));gap:12px;margin-bottom:20px">';
  [['#667eea',a.length,'Intentos'],['#667eea',avg+'%','Promedio'],['#10b981',best+'%','Mejor'],['#ef4444',worst+'%','Peor'],['#f59e0b',historicallyIncorrect.size,'Dif√≠ciles'],['#8b5cf6',bookmarkedQuestions.size,'Marcadas']].forEach(([c,v,l])=>{
    html+='<div style="padding:15px;border-radius:10px;background:#f8f9ff"><div style="font-size:26px;font-weight:bold;color:'+c+'">'+v+'</div><div style="font-size:12px;color:#666">'+l+'</div></div>';
  });
  html+='</div><h3 style="margin:10px 0;color:#667eea">üìà Evoluci√≥n de Puntuaciones</h3>'+getProgressChart()+'<h3 style="margin:15px 0 10px;color:#667eea">√öltimos 5 Intentos</h3>';
  a.slice(-5).reverse().forEach((x,i)=>{
    const c=x.percentage>=70?'#10b981':x.percentage>=50?'#f59e0b':'#ef4444';
    html+='<div style="padding:12px 15px;margin:6px 0;background:#f8f9ff;border-radius:8px;display:flex;justify-content:space-between;align-items:center"><span><strong>Intento '+(a.length-i)+'</strong> ¬∑ '+new Date(x.date).toLocaleDateString()+'</span><span style="color:'+c+';font-weight:bold;font-size:16px">'+x.percentage+'% ('+x.score+'/'+x.total+')</span></div>';
  });
  html+='<div style="display:flex;gap:10px;justify-content:center;margin-top:25px;flex-wrap:wrap"><button onclick="location.reload()" style="padding:12px 25px;background:#6b7280;color:white;border:none;border-radius:10px;font-size:15px;font-weight:600;cursor:pointer">‚Üê Volver</button><button onclick="quickReview()" style="padding:12px 25px;background:#f59e0b;color:white;border:none;border-radius:10px;font-size:15px;font-weight:600;cursor:pointer">üéØ Repaso R√°pido</button><button onclick="exportResults()" style="padding:12px 25px;background:#3b82f6;color:white;border:none;border-radius:10px;font-size:15px;font-weight:600;cursor:pointer">üìÑ Exportar</button></div></div>';
  document.getElementById('configPanel').classList.add('hidden');
  document.getElementById('progressBar').classList.add('hidden');
  document.getElementById('quizContent').classList.remove('hidden');
  document.getElementById('quizContent').innerHTML=html;
}

function exportResults(){
  const a=getAttemptHistory();
  let t='ORACLE 1Z0-133 - HISTORIAL DE RESULTADOS\n===========================================\n\n';
  a.forEach((x,i)=>{t+='Intento '+(i+1)+': '+new Date(x.date).toLocaleString()+'\nPuntuaci√≥n: '+x.score+'/'+x.total+' ('+x.percentage+'%)\n\n';});
  const blob=new Blob([t],{type:'text/plain'});
  const url=URL.createObjectURL(blob);
  const el=document.createElement('a');el.href=url;el.download='oracle-quiz-resultados.txt';el.click();
}

// HOOKS - se ejecutan DESPU√âS de las funciones originales

function startQuiz(cont){
  loadHistoricalData();
  examMode=(quizMode==='exam');
  _baseStartQuiz(cont);

  // Aplicar filtros especiales despu√©s de cargar preguntas del rango
  const onlyIncorrect=document.getElementById('onlyIncorrect')?.checked||false;
  const onlyBookmarked=document.getElementById('onlyBookmarked')?.checked||false;
  if(onlyIncorrect){
    questions=questions.filter(q=>historicallyIncorrect.has(q.number));
    if(questions.length===0){alert('üéâ ¬°No tienes preguntas incorrectas! ¬°Excelente!');location.reload();return;}
  }
  if(onlyBookmarked){
    questions=questions.filter(q=>bookmarkedQuestions.has(q.number));
    if(questions.length===0){alert('üìå No has marcado ninguna pregunta todav√≠a.');location.reload();return;}
  }

  if(examMode){const td=document.getElementById('timerDisplay');if(td){td.classList.remove('hidden');startTimer();}}
  currentQuestion=0;
  loadQuestion();
}


function loadQuestion(){
  _baseLoadquestion();
  const q=questions[currentQuestion];if(!q)return;
  const qc=document.getElementById('quizContent');
  const qn=qc.querySelector('.question-number');
  if(qn){
    qn.innerHTML+=getDifficultyBadge(q.number);
    const bm=bookmarkedQuestions.has(q.number);
    const bmBtn=document.createElement('button');
    bmBtn.style.cssText='background:'+(bm?'#10b981':'#fbbf24')+';color:'+(bm?'white':'#1a1a1a')+';border:none;padding:4px 10px;border-radius:6px;cursor:pointer;font-size:11px;font-weight:600;margin-left:8px';
    bmBtn.textContent=bm?'‚≠ê Marcada':'üìå Marcar';
    bmBtn.onclick=()=>toggleBookmark(q.number);
    qn.appendChild(bmBtn);
  }
  if(currentQuestion===0){const sb=qc.querySelector('.score-board');if(sb)sb.insertAdjacentHTML('beforebegin',getMotivation());}
  if(examMode){
    const sb=qc.querySelector('.score-board');
    if(sb)sb.insertAdjacentHTML('beforebegin','<div style="background:#fef3c7;border:2px solid #f59e0b;color:#92400e;padding:12px;border-radius:10px;text-align:center;font-weight:600;margin-bottom:15px">üéØ MODO EXAMEN: Puedes revisar preguntas anteriores ya respondidas, pero no cambiar las respuestas verificadas</div>');
    const pb=qc.querySelector('.btn-prev');
    if(pb){
      // Solo permitir retroceder si hay preguntas anteriores ya respondidas o verificadas
      const canGoBack=currentQuestion>0;
      pb.disabled=!canGoBack;
      if(canGoBack){
        pb.style.background='#6b7280';
        pb.title='Volver a revisar pregunta anterior';
      }
    }
  }
  const ctrl=qc.querySelector('.controls');
  if(ctrl){
    const note=getNote(q.number);
    ctrl.insertAdjacentHTML('beforebegin','<div style="margin-top:15px;padding:15px;border-radius:10px;border:2px dashed #667eea;background:#f8f9ff"><div style="font-size:12px;font-weight:600;color:#667eea;margin-bottom:6px">üìù Mi Nota Personal:</div><textarea id="note-'+q.number+'" style="width:100%;padding:8px;border:1px solid #e0e0e0;border-radius:6px;font-size:12px;resize:vertical;min-height:50px;font-family:inherit" placeholder="Escribe tus apuntes sobre esta pregunta...">'+note+'</textarea><button onclick="saveNote('+q.number+')" style="background:#667eea;color:white;border:none;padding:5px 12px;border-radius:6px;cursor:pointer;font-size:12px;margin-top:5px">üíæ Guardar Nota</button></div>');
  }
}


function _baseCheckAnswerV12(){
  const q=questions[currentQuestion];
  const ua=answers[q.number];if(!ua||ua.length===0)return;
  const ok=ua.length===q.correct.length&&ua.every(a=>q.correct.includes(a));
  _baseCheckanswer();
  updateDifficulty(q.number,ok);checkAchievements(ok);
  if(ok)historicallyIncorrect.delete(q.number);else historicallyIncorrect.add(q.number);
  saveHistoricalData();
}


function _baseShowResultsV12(){
  const t=examMode?stopTimer():0;
  _baseShowresults();
  saveAttempt(correctCount,questions.length,t);
  if(examMode){const td=document.getElementById('timerDisplay');if(td)td.classList.add('hidden');}
  const fr=document.querySelector('.final-results');
  if(fr){
    if(t>0){const td=document.createElement('div');td.style.cssText='font-size:18px;color:#667eea;margin:10px 0';td.innerHTML='‚è±Ô∏è Tiempo: '+Math.floor(t/60)+':'+String(t%60).padStart(2,'0');const fs=fr.querySelector('.final-score');if(fs)fs.insertAdjacentElement('afterend',td);}
    if(historicallyIncorrect.size>0){const btn=document.createElement('button');btn.style.cssText='background:#f59e0b;color:white;border:none;padding:12px 25px;border-radius:10px;font-size:15px;font-weight:600;cursor:pointer;margin-top:10px;display:block;margin-left:auto;margin-right:auto';btn.innerHTML='üéØ Repasar '+historicallyIncorrect.size+' Incorrectas';btn.onclick=quickReview;fr.appendChild(btn);}
  }
}



// Cargar progreso al iniciar si existe
window.addEventListener('load',()=>{
  loadHistoricalData();
  if(localStorage.getItem('darkMode')==='true'){
    document.body.classList.add('dark-mode');
    const btn=document.querySelector('.dark-mode-toggle');
    if(btn)btn.textContent='‚òÄÔ∏è Modo Claro';
  }
  const saved=localStorage.getItem('oracleQuizProgress');
  if(saved){
    document.getElementById('continueBtn').style.display='inline-block';
    // Si hab√≠a una sesi√≥n activa, restaurarla autom√°ticamente con F5
    const data=JSON.parse(saved);
    if(data.quizActive){
      restoreSession();
    }
  }
});

// Restaurar sesi√≥n cuando el usuario pulsa "Continuar donde qued√©" o con F5
function restoreSession(){
  const saved=localStorage.getItem('oracleQuizProgress');
  if(!saved)return;
  try{
    const data=JSON.parse(saved);
    quizMode=data.savedQuizMode||'practice';
    examMode=data.savedExamMode||false;
    if(data.savedQuestionNumbers&&data.savedQuestionNumbers.length>0){
      questions=data.savedQuestionNumbers.map(n=>allQuestions.find(q=>q.number===n)).filter(Boolean);
    } else {
      const s=data.questionRange?.start||1;
      const e=data.questionRange?.end||127;
      questions=allQuestions.filter(q=>q.number>=s&&q.number<=e);
    }
    answers=data.answers||{};
    checkedQuestions=data.checkedQuestions||{};
    correctCount=data.correctCount||0;
    incorrectCount=data.incorrectCount||0;
    currentQuestion=data.currentQuestion||0;
    quizStarted=true;
    document.getElementById('configPanel').classList.add('hidden');
    document.getElementById('progressBar').classList.remove('hidden');
    document.getElementById('quizContent').classList.remove('hidden');
    if(examMode){
      const td=document.getElementById('timerDisplay');
      if(td)td.classList.remove('hidden');
      startTimer();
    }
    loadQuestion();
  } catch(e){
    console.warn('Error restaurando sesi√≥n:',e);
  }
}

// ===== MAPA DE TEMAS POR PREGUNTA =====
const questionTopics={
  cluster:[7,14,17,24,29,31,33,36,38,43,44,55,62,67,74,80,86,92,97,103,110,117,122],
  node:[5,13,22,30,34,36,40,44,46,52,58,63,70,76,82,88,95,101,107,114,120,126],
  jdbc:[2,6,21,28,42,43,47,53,59,65,71,77,83,89,96,102,108,115,121,127],
  security:[26,48,54,60,66,72,78,84,90],
  deploy:[1,16,25,37,50,56,61,68,73,79,85,91,98,104,111,116,123],
  domain:[4,8,10,30,34,39,40,45,51,57,64,69,75,81,87,93,99,105,112,118,124],
  monitor:[12,15,19,27,32,41,49,100,106,113,119,125],
  jvm:[18,9,20,23,35,38]
};

// ===== FILTRO POR TEMA =====
// (se aplica dentro del startQuiz unificado abajo)

// ===== MODO SIMULACRO REAL =====
let simulacroTimerInterval=null;
function _baseStartSimulacroTimerV12(totalSeconds){
  clearInterval(simulacroTimerInterval);
  let remaining=totalSeconds;
  const td=document.getElementById('timerDisplay');
  function update(){
    const h=Math.floor(remaining/3600);
    const m=Math.floor((remaining%3600)/60);
    const s=remaining%60;
    if(td)td.innerHTML='üéØ SIMULACRO &nbsp; ‚è±Ô∏è '+String(h).padStart(2,'0')+':'+String(m).padStart(2,'0')+':'+String(s).padStart(2,'0');
    if(remaining<=300&&td)td.style.background='#ef4444';
    if(remaining<=0){
      clearInterval(simulacroTimerInterval);
      alert('‚è∞ ¬°Tiempo agotado! El examen ha finalizado.');
      showResults();
      return;
    }
    remaining--;
  }
  update();
  simulacroTimerInterval=setInterval(update,1000);
}

// Hook selectMode para manejar flashcard y simulacro
(function(){
  const _origSM=selectMode;
  selectMode=function(mode,event){
    if(mode==='flashcard'||mode==='simulacro'){
      document.querySelectorAll('.mode-btn').forEach(b=>b.classList.remove('selected'));
      if(event?.currentTarget)event.currentTarget.classList.add('selected');
      quizMode=mode;
      return;
    }
    _origSM(mode,event);
  };
})();

// ===== PUNTO DE ENTRADA √öNICO para startQuiz =====
(function(){
  const _origSQ=startQuiz;
  startQuiz=function(cont){

    // --- MODO FLASHCARD ---
    if(quizMode==='flashcard'){
      loadHistoricalData();
      const s=parseInt(document.getElementById('startQuestion').value)||1;
      const e=parseInt(document.getElementById('endQuestion').value)||127;
      questions=allQuestions.filter(q=>q.number>=s&&q.number<=e);
      const topic=document.getElementById('topicFilter')?.value||'all';
      if(topic!=='all'){const nums=questionTopics[topic]||[];questions=questions.filter(q=>nums.includes(q.number));}
      if(document.getElementById('randomOrder')?.checked)questions=questions.sort(()=>Math.random()-0.5);
      if(questions.length===0){alert('‚ö†Ô∏è No hay preguntas con esos filtros.');return;}
      document.getElementById('configPanel').classList.add('hidden');
      document.getElementById('progressBar').classList.add('hidden');
      document.getElementById('quizContent').classList.remove('hidden');
      fcList=[...questions];fcIndex=0;fcKnew.clear();fcReview.clear();
      showFlashcard();
      return;
    }

    // --- MODO SIMULACRO ---
    if(quizMode==='simulacro'){
      loadHistoricalData();
      const shuffled=[...allQuestions].sort(()=>Math.random()-0.5).slice(0,70);
      questions=shuffled;
      answers={};
      currentQuestion=0;
      correctCount=0;
      examMode=true;
      document.getElementById('configPanel').classList.add('hidden');
      document.getElementById('progressBar').classList.remove('hidden');
      document.getElementById('quizContent').classList.remove('hidden');
      const td=document.getElementById('timerDisplay');
      if(td)td.classList.remove('hidden');
      startSimulacroTimer(105*60);
      const h1=document.querySelector('.header h1');
      if(h1&&!h1.querySelector('.simulacro-badge')){
        const badge=document.createElement('span');
        badge.className='simulacro-badge';
        badge.textContent='SIMULACRO';
        h1.appendChild(badge);
      }
      loadQuestion();
      return;
    }

    // --- MODOS NORMALES (practice / exam) ---
    _origSQ(cont);

    // Aplicar filtro de tema si est√° seleccionado
    const topic=document.getElementById('topicFilter')?.value||'all';
    if(topic!=='all'){
      const nums=questionTopics[topic]||[];
      questions=questions.filter(q=>nums.includes(q.number));
      if(questions.length===0){alert('‚ö†Ô∏è No hay preguntas de ese tema en el rango seleccionado.');location.reload();return;}
      currentQuestion=0;
      loadQuestion();
    }
  };
})();

// ===== TEMPORIZADOR POR PREGUNTA =====
let qTimerInterval=null;
let qTimerSeconds=90;

function startQTimer(){
  clearInterval(qTimerInterval);
  qTimerSeconds=90;
  updateQTimerUI();
  qTimerInterval=setInterval(()=>{
    qTimerSeconds--;
    updateQTimerUI();
    if(qTimerSeconds<=0){
      clearInterval(qTimerInterval);
      const bar=document.getElementById('qtimer-fill');
      if(bar)bar.style.width='0%';
      // Si no hay respuesta marcada, pasar directamente a la siguiente
      const q=questions[currentQuestion];
      if(q){
        if(!answers[q.number]||answers[q.number].length===0){
          // Sin respuesta: avanzar directamente
          if(currentQuestion===questions.length-1) showResults();
          else { currentQuestion++; loadQuestion(); }
        } else if(!checkedQuestions[q.number]){
          // Hay respuesta pero no verificada: verificar y luego avanzar
          checkAnswer();
          setTimeout(()=>{
            if(currentQuestion===questions.length-1) showResults();
            else { currentQuestion++; loadQuestion(); }
          },1500);
        }
      }
    }
  },1000);
}

function updateQTimerUI(){
  const fill=document.getElementById('qtimer-fill');
  const label=document.getElementById('qtimer-label');
  if(!fill||!label)return;
  const pct=(qTimerSeconds/90)*100;
  fill.style.width=pct+'%';
  if(qTimerSeconds<=20)fill.classList.add('warning');
  else fill.classList.remove('warning');
  label.textContent='‚è±Ô∏è '+qTimerSeconds+'s';
}

// Hook loadQuestion para a√±adir timer por pregunta
(function(){
  const _origLQ2=loadQuestion;
  loadQuestion=function(){
    _origLQ2();
    clearInterval(qTimerInterval);
    if(document.getElementById('useQTimer')?.checked){
      const qc=document.getElementById('quizContent');
      const qn=qc?.querySelector('.question-number');
      if(qn){
        const timerDiv=document.createElement('div');
        timerDiv.innerHTML='<div style="margin-bottom:10px"><div id="qtimer-label" class="qtimer-label">‚è±Ô∏è 90s</div><div class="qtimer-bar"><div id="qtimer-fill" class="qtimer-fill" style="width:100%"></div></div></div>';
        qn.insertAdjacentElement('afterend',timerDiv.firstElementChild);
        startQTimer();
      }
    }
  };
  // Detener timer al verificar
  const _origCA2=checkAnswer;
  checkAnswer=function(){
    clearInterval(qTimerInterval);
    _origCA2();
  };
})();

// ===== MODO FLASHCARD =====
let fcIndex=0;
let fcList=[];
let fcKnew=new Set();
let fcReview=new Set();

function startFlashcardMode(){
  loadHistoricalData();
  fcList=[...questions];
  fcIndex=0;
  fcKnew.clear();
  fcReview.clear();
  document.getElementById('configPanel').classList.add('hidden');
  document.getElementById('progressBar').classList.add('hidden');
  document.getElementById('quizContent').classList.remove('hidden');
  showFlashcard();
}

function showFlashcard(){
  if(fcIndex>=fcList.length){
    showFlashcardResults();
    return;
  }
  const q=fcList[fcIndex];
  const correctText=q.correct.map(i=>String.fromCharCode(65+i)+') '+q.options[i]).join('<br>');
  const total=fcList.length;
  const qc=document.getElementById('quizContent');
  qc.innerHTML=`
    <div style="padding:30px">
      <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:15px">
        <span style="color:#667eea;font-weight:700;font-size:14px">üÉè Flashcard ${fcIndex+1} / ${total}</span>
        <div style="display:flex;gap:8px">
          <span style="background:#10b981;color:white;padding:3px 10px;border-radius:20px;font-size:12px;font-weight:600">‚úÖ ${fcKnew.size}</span>
          <span style="background:#ef4444;color:white;padding:3px 10px;border-radius:20px;font-size:12px;font-weight:600">üîÅ ${fcReview.size}</span>
        </div>
        <button onclick="location.reload()" style="padding:8px 16px;background:#6b7280;color:white;border:none;border-radius:8px;cursor:pointer;font-weight:600;font-size:13px">‚Üê Salir</button>
      </div>
      <div class="flashcard-container">
        <div class="flashcard" id="flashcard" onclick="flipCard()">
          <div class="flashcard-front">
            <div style="font-size:13px;opacity:0.8;margin-bottom:12px">Pregunta ${q.number}</div>
            <div>${q.text}</div>
            <div class="flashcard-hint">üëÜ Haz clic para ver la respuesta</div>
          </div>
          <div class="flashcard-back">
            <div style="font-size:13px;font-weight:700;color:#667eea;margin-bottom:12px">‚úÖ Respuesta correcta:</div>
            <div style="font-size:15px;line-height:1.6">${correctText}</div>
          </div>
        </div>
      </div>
      <div class="fc-controls">
        <button class="btn-fc btn-fc-flip" onclick="flipCard()">üîÑ Voltear</button>
        <button class="btn-fc btn-fc-knew" onclick="fcAnswer(true)">‚úÖ Lo sab√≠a</button>
        <button class="btn-fc btn-fc-review" onclick="fcAnswer(false)">üîÅ Repasar</button>
        <button class="btn-fc btn-fc-skip" onclick="fcSkip()">‚è≠Ô∏è Saltar</button>
      </div>
    </div>`;
}

function flipCard(){
  document.getElementById('flashcard')?.classList.toggle('flipped');
}

function fcAnswer(knew){
  const q=fcList[fcIndex];
  if(knew)fcKnew.add(q.number);
  else fcReview.add(q.number);
  fcIndex++;
  showFlashcard();
}

function fcSkip(){
  fcIndex++;
  showFlashcard();
}

function showFlashcardResults(){
  const qc=document.getElementById('quizContent');
  const pct=Math.round((fcKnew.size/fcList.length)*100);
  const c=pct>=70?'#10b981':pct>=50?'#f59e0b':'#ef4444';
  qc.innerHTML=`
    <div style="padding:40px;text-align:center">
      <h2 style="color:#667eea;margin-bottom:20px">üÉè Resultado Flashcards</h2>
      <div style="font-size:56px;font-weight:bold;color:${c};margin:20px 0">${pct}%</div>
      <p style="color:#666;margin-bottom:25px">Sab√≠as <strong>${fcKnew.size}</strong> de <strong>${fcList.length}</strong> tarjetas</p>
      <div style="display:flex;gap:15px;justify-content:center;flex-wrap:wrap">
        <button onclick="location.reload()" style="padding:12px 25px;background:#6b7280;color:white;border:none;border-radius:10px;font-size:15px;font-weight:600;cursor:pointer">‚Üê Men√∫ Principal</button>
        ${fcReview.size>0?'<button onclick="fcRepeatWrong()" style="padding:12px 25px;background:#ef4444;color:white;border:none;border-radius:10px;font-size:15px;font-weight:600;cursor:pointer">üîÅ Repetir las '+fcReview.size+' pendientes</button>':''}
      </div>
    </div>`;
}

function fcRepeatWrong(){
  fcList=fcList.filter(q=>fcReview.has(q.number));
  fcIndex=0;
  fcKnew.clear();
  fcReview.clear();
  showFlashcard();
}



// ===== EXPORTAR INCORRECTAS A PDF =====
function exportIncorrectasPDF(){
  loadHistoricalData();
  const list=Array.from(historicallyIncorrect);
  if(list.length===0){alert('üéâ ¬°No tienes preguntas incorrectas para exportar!');return;}

  let html=`<!DOCTYPE html><html><head><meta charset="UTF-8">
  <title>Oracle 1z0-133 - Preguntas Incorrectas</title>
  <style>
    body{font-family:Arial,sans-serif;padding:30px;color:#333;max-width:800px;margin:0 auto}
    h1{color:#667eea;border-bottom:3px solid #667eea;padding-bottom:10px}
    .meta{color:#888;font-size:13px;margin-bottom:25px}
    .question{margin-bottom:25px;padding:20px;border-left:5px solid #ef4444;background:#fff5f5;border-radius:0 10px 10px 0;page-break-inside:avoid}
    .qnum{font-size:12px;color:#ef4444;font-weight:700;margin-bottom:8px}
    .qtext{font-size:15px;font-weight:600;margin-bottom:12px;line-height:1.5}
    .answer{color:#065f46;font-weight:600;font-size:14px;background:#d1fae5;padding:10px;border-radius:6px}
    @media print{body{padding:15px}.question{break-inside:avoid}}
  </style></head><body>
  <h1>üìï Oracle 1z0-133 - Preguntas Incorrectas</h1>
  <div class="meta">Generado el ${new Date().toLocaleDateString('es-ES',{day:'2-digit',month:'long',year:'numeric'})} ¬∑ ${list.length} preguntas pendientes de dominar</div>`;

  list.sort((a,b)=>a-b).forEach(n=>{
    const q=allQuestions.find(x=>x.number===n);if(!q)return;
    const ans=q.correct.map(i=>String.fromCharCode(65+i)+') '+q.options[i]).join('<br>');
    html+=`<div class="question">
      <div class="qnum">PREGUNTA ${q.number}</div>
      <div class="qtext">${q.text}</div>
      <div class="answer">‚úÖ Respuesta correcta:<br>${ans}</div>
    </div>`;
  });

  html+=`</body></html>`;

  const blob=new Blob([html],{type:'text/html'});
  const url=URL.createObjectURL(blob);
  const win=window.open(url,'_blank');
  if(win){
    setTimeout(()=>{win.print();},500);
  }
}

// ===== ‚å®Ô∏è ATAJOS DE TECLADO =====
document.addEventListener('keydown',(e)=>{
  if(!quizStarted)return;
  if(e.target.tagName==='TEXTAREA'||e.target.tagName==='INPUT')return;
  const key=e.key;
  if((key>='a'&&key<='f')||(key>='A'&&key<='F')){
    const idx=key.toUpperCase().charCodeAt(0)-65;
    const opts=document.querySelectorAll('.option:not(.disabled)');
    if(opts[idx])opts[idx].click();
  }
  // Enter deshabilitado: solo se puede verificar pulsando el bot√≥n
  if(key==='ArrowRight'){const btn=document.querySelector('.btn-next');if(btn)btn.click();}
  if(key==='ArrowLeft'){const btn=document.querySelector('.btn-prev:not(:disabled)');if(btn)btn.click();}
  if(key==='m'||key==='M'){const q=questions[currentQuestion];if(q)toggleBookmark(q.number);}
});

(function(){
  const _origLQkeys=loadQuestion;
  loadQuestion=function(){
    _origLQkeys();
    const qc=document.getElementById('quizContent');
    if(qc&&!qc.querySelector('.keys-hint')){
      const hint=document.createElement('div');
      hint.className='keys-hint';
      hint.style.cssText='font-size:11px;color:#aaa;text-align:center;margin-top:8px;padding:5px';
      hint.innerHTML='‚å®Ô∏è <b>A-F</b> seleccionar &nbsp;|&nbsp; <b>‚Üí ‚Üê</b> navegar &nbsp;|&nbsp; <b>M</b> marcar';
      qc.appendChild(hint);
    }
  };
})();

// ===== üîç BUSCAR PREGUNTA =====
(function(){
  window.addEventListener('load',()=>{
    setTimeout(()=>{
      const info=document.querySelector('.info-message');
      if(info&&!document.getElementById('searchBox')){
        const sd=document.createElement('div');
        sd.style.cssText='margin-top:12px;display:flex;gap:8px;align-items:center';
        sd.innerHTML='<input id="searchBox" type="text" placeholder="üîç Buscar pregunta por palabra clave..." style="flex:1;padding:10px;border:2px solid #e0e0e0;border-radius:8px;font-size:14px;font-family:inherit" oninput="searchQuestions(this.value)"><button onclick="clearSearch()" style="padding:10px 15px;background:#6b7280;color:white;border:none;border-radius:8px;cursor:pointer;font-size:13px;font-weight:600">‚úï</button>';
        info.insertAdjacentElement('afterend',sd);
        const rd=document.createElement('div');
        rd.id='searchResults';
        rd.style.cssText='margin-top:8px;max-height:250px;overflow-y:auto;border-radius:8px';
        sd.insertAdjacentElement('afterend',rd);
      }
    },100);
  });
})();

function searchQuestions(term){
  const res=document.getElementById('searchResults');
  if(!res)return;
  if(!term||term.length<2){res.innerHTML='';return;}
  const matches=allQuestions.filter(q=>q.text.toLowerCase().includes(term.toLowerCase()));
  if(matches.length===0){res.innerHTML='<div style="padding:12px;color:#888;text-align:center">No se encontraron resultados</div>';return;}
  res.innerHTML=matches.slice(0,10).map(q=>'<div onclick="goToQuestion('+q.number+')" style="padding:10px 14px;border-bottom:1px solid #e0e0e0;cursor:pointer;font-size:13px;background:white" onmouseover="this.style.background=\'#f0f4ff\'" onmouseout="this.style.background=\'white\'"><span style="color:#667eea;font-weight:700">P'+q.number+'</span> ‚Äî '+q.text.substring(0,80)+'...</div>').join('')+(matches.length>10?'<div style="padding:8px;text-align:center;font-size:12px;color:#888">+'+( matches.length-10)+' m√°s resultados</div>':'');
}

function clearSearch(){
  const b=document.getElementById('searchBox');const r=document.getElementById('searchResults');
  if(b)b.value='';if(r)r.innerHTML='';
}

function goToQuestion(num){
  clearSearch();
  const s=parseInt(document.getElementById('startQuestion').value)||1;
  const e=parseInt(document.getElementById('endQuestion').value)||127;
  questions=allQuestions.filter(q=>q.number>=s&&q.number<=e);
  if(questions.length===0)questions=[...allQuestions];
  const idx=questions.findIndex(q=>q.number===num);
  if(idx===-1){alert('Esa pregunta no est√° en el rango actual.');return;}
  answers={};checkedQuestions={};correctCount=0;incorrectCount=0;
  currentQuestion=idx;quizStarted=true;examMode=false;
  document.getElementById('configPanel').classList.add('hidden');
  document.getElementById('progressBar').classList.remove('hidden');
  document.getElementById('quizContent').classList.remove('hidden');
  loadQuestion();
}

// ===== üìÖ RACHA DIARIA + CALENDARIO =====
function getDailyStreak(){
  const attempts=getAttemptHistory();
  if(attempts.length===0)return{streak:0,dates:[]};
  const dates=[...new Set(attempts.map(a=>a.date.split('T')[0]))].sort();
  let streak=0;
  const today=new Date().toISOString().split('T')[0];
  let check=today;
  for(let i=dates.length-1;i>=0;i--){
    if(dates[i]===check){streak++;const d=new Date(check);d.setDate(d.getDate()-1);check=d.toISOString().split('T')[0];}
    else if(dates[i]<check)break;
  }
  return{streak,dates};
}

function showStreakCalendar(){
  loadHistoricalData();
  const{streak,dates}=getDailyStreak();
  const dateSet=new Set(dates);
  const today=new Date();
  let calHTML='<div style="display:grid;grid-template-columns:repeat(7,1fr);gap:4px;margin:15px 0">';
  ['L','M','X','J','V','S','D'].forEach(d=>{calHTML+='<div style="text-align:center;font-size:11px;color:#888;font-weight:600">'+d+'</div>';});
  const start=new Date(today);start.setDate(start.getDate()-((start.getDay()||7)-1)-63);
  for(let i=0;i<70;i++){
    const d=new Date(start);d.setDate(d.getDate()+i);
    const ds=d.toISOString().split('T')[0];
    const isToday=ds===today.toISOString().split('T')[0];
    const studied=dateSet.has(ds);const future=d>today;
    const bg=future?'#f0f0f0':studied?'#667eea':'#e0e0e0';
    const border=isToday?'2px solid #764ba2':'2px solid transparent';
    calHTML+='<div title="'+ds+'" style="aspect-ratio:1;border-radius:4px;background:'+bg+';border:'+border+';display:flex;align-items:center;justify-content:center;font-size:10px;font-weight:700;color:'+(studied?'white':future?'#ccc':'#999')+'">'+d.getDate()+'</div>';
  }
  calHTML+='</div>';
  const qc=document.getElementById('quizContent');
  document.getElementById('configPanel').classList.add('hidden');
  document.getElementById('progressBar').classList.add('hidden');
  qc.classList.remove('hidden');
  qc.innerHTML='<div style="padding:30px"><div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:20px"><h2 style="color:#667eea">üìÖ Racha Diaria</h2><button onclick="backToHomeFromExtra()" style="padding:10px 20px;background:#6b7280;color:white;border:none;border-radius:8px;cursor:pointer;font-weight:600">‚Üê Volver</button></div><div style="text-align:center;margin-bottom:20px"><div style="font-size:64px">'+(streak>=7?'üî•':streak>=3?'‚ö°':'üìö')+'</div><div style="font-size:48px;font-weight:bold;color:#667eea">'+streak+'</div><div style="color:#888;font-size:16px">'+(streak===1?'d√≠a seguido':streak+' d√≠as seguidos')+'</div>'+(streak>=7?'<div style="color:#f59e0b;font-weight:600;margin-top:8px">¬°Racha incre√≠ble! üî•</div>':'')+'</div><h3 style="color:#667eea;margin-bottom:10px">üìÜ √öltimas 10 semanas</h3><div style="display:flex;gap:12px;align-items:center;margin-bottom:8px;font-size:12px"><span><span style="display:inline-block;width:12px;height:12px;background:#667eea;border-radius:2px;margin-right:4px"></span>Estudi√©</span><span><span style="display:inline-block;width:12px;height:12px;background:#e0e0e0;border-radius:2px;margin-right:4px"></span>Sin estudio</span></div>'+calHTML+'<p style="color:#888;font-size:13px;text-align:center;margin-top:10px">Total d√≠as estudiados: <strong>'+dates.length+'</strong></p></div>';
}

// ===== üó∫Ô∏è DOMINIO POR TEMA =====
function showTopicMastery(){
  loadHistoricalData();
  const topicNames={cluster:'üîó Clusters',node:'üñ•Ô∏è Node Manager',jdbc:'üóÑÔ∏è JDBC / Data Sources',security:'üîí Seguridad',deploy:'üöÄ Deployment',domain:'üèóÔ∏è Dominios',monitor:'üìä Monitorizaci√≥n',jvm:'‚òï JVM / Rendimiento'};
  const rows=Object.entries(questionTopics).map(([key,nums])=>{
    const total=nums.length;
    const incorrect=nums.filter(n=>historicallyIncorrect.has(n)).length;
    const correct=total-incorrect;
    const pct=total>0?Math.round((correct/total)*100):100;
    const color=pct>=80?'#10b981':pct>=60?'#667eea':pct>=40?'#f59e0b':'#ef4444';
    const emoji=pct>=80?'üèÜ':pct>=60?'üëç':pct>=40?'üìö':'üí™';
    return{name:topicNames[key],total,correct,pct,color,emoji};
  }).sort((a,b)=>b.pct-a.pct);
  const qc=document.getElementById('quizContent');
  document.getElementById('configPanel').classList.add('hidden');
  document.getElementById('progressBar').classList.add('hidden');
  qc.classList.remove('hidden');
  qc.innerHTML='<div style="padding:30px"><div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:20px"><h2 style="color:#667eea">üó∫Ô∏è Dominio por Tema</h2><button onclick="backToHomeFromExtra()" style="padding:10px 20px;background:#6b7280;color:white;border:none;border-radius:8px;cursor:pointer;font-weight:600">‚Üê Volver</button></div><p style="color:#888;font-size:13px;margin-bottom:20px">Basado en tu historial de respuestas incorrectas guardadas.</p>'+rows.map(r=>'<div style="margin-bottom:16px"><div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:6px"><span style="font-weight:600;font-size:15px">'+r.emoji+' '+r.name+'</span><span style="font-weight:700;color:'+r.color+';font-size:16px">'+r.pct+'%</span></div><div style="background:#e0e0e0;border-radius:8px;height:14px;overflow:hidden"><div style="width:'+r.pct+'%;background:'+r.color+';height:100%;border-radius:8px"></div></div><div style="font-size:11px;color:#888;margin-top:3px">'+r.correct+' de '+r.total+' preguntas sin errores</div></div>').join('')+'</div>';
}

// ===== üèÜ TABLA DE PUNTUACIONES =====
function showLeaderboard(){
  loadHistoricalData();
  const attempts=getAttemptHistory();
  if(attempts.length===0){alert('üìä A√∫n no tienes intentos. ¬°Completa tu primer quiz!');return;}
  const sorted=[...attempts].sort((a,b)=>b.percentage-a.percentage);
  const medals=['ü•á','ü•à','ü•â'];
  const bgColors=['linear-gradient(135deg,#fef3c7,#fde68a)','linear-gradient(135deg,#f1f5f9,#e2e8f0)','linear-gradient(135deg,#fef3c7,#fed7aa)'];
  const borders=['#f59e0b','#94a3b8','#f97316'];
  const qc=document.getElementById('quizContent');
  document.getElementById('configPanel').classList.add('hidden');
  document.getElementById('progressBar').classList.add('hidden');
  qc.classList.remove('hidden');
  qc.innerHTML='<div style="padding:30px"><div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:20px"><h2 style="color:#667eea">üèÜ Mejores Puntuaciones</h2><button onclick="backToHomeFromExtra()" style="padding:10px 20px;background:#6b7280;color:white;border:none;border-radius:8px;cursor:pointer;font-weight:600">‚Üê Volver</button></div>'+sorted.slice(0,3).map((a,i)=>'<div style="padding:20px;border-radius:16px;margin-bottom:12px;background:'+bgColors[i]+';border:2px solid '+borders[i]+'"><div style="display:flex;align-items:center;gap:15px"><div style="font-size:40px">'+medals[i]+'</div><div><div style="font-size:22px;font-weight:bold;color:#333">'+a.percentage+'%</div><div style="font-size:13px;color:#666">'+a.score+'/'+a.total+' correctas ¬∑ '+new Date(a.date).toLocaleDateString('es-ES')+'</div></div></div></div>').join('')+'<h3 style="color:#667eea;margin:20px 0 10px">üìã Todos los intentos</h3><div style="max-height:300px;overflow-y:auto">'+sorted.map((a,i)=>{const c=a.percentage>=70?'#10b981':a.percentage>=50?'#f59e0b':'#ef4444';return'<div style="padding:12px 15px;margin:5px 0;background:#f8f9ff;border-radius:8px;display:flex;justify-content:space-between;align-items:center"><span style="font-size:14px">#'+(i+1)+' ¬∑ '+new Date(a.date).toLocaleDateString('es-ES',{day:'2-digit',month:'short',year:'numeric'})+'</span><span style="font-weight:bold;color:'+c+';font-size:16px">'+a.percentage+'% ('+a.score+'/'+a.total+')</span></div>';}).join('')+'</div></div>';
}

// ===== üéµ SONIDOS =====
let soundEnabled=localStorage.getItem('soundEnabled')!=='false';

function playSound(type){
  if(!soundEnabled)return;
  try{
    const ctx=new(window.AudioContext||window.webkitAudioContext)();
    if(type==='correct'){
      // ‚úÖ ACIERTO: dos notas ascendentes alegres (Do-Mi) ‚Äî melod√≠a corta positiva
      [{f:523,t:0},{f:659,t:0.12},{f:784,t:0.24}].forEach(({f,t})=>{
        const o=ctx.createOscillator(),g=ctx.createGain();
        o.connect(g);g.connect(ctx.destination);
        o.type='sine';o.frequency.value=f;
        g.gain.setValueAtTime(0,ctx.currentTime+t);
        g.gain.linearRampToValueAtTime(0.28,ctx.currentTime+t+0.03);
        g.gain.exponentialRampToValueAtTime(0.001,ctx.currentTime+t+0.18);
        o.start(ctx.currentTime+t);o.stop(ctx.currentTime+t+0.2);
      });
    } else if(type==='incorrect'){
      // ‚ùå ERROR: dos notas descendentes graves (tipo "buzz") ‚Äî claramente negativo
      [{f:320,t:0,tp:'sawtooth'},{f:200,t:0.18,tp:'sawtooth'}].forEach(({f,t,tp})=>{
        const o=ctx.createOscillator(),g=ctx.createGain();
        o.connect(g);g.connect(ctx.destination);
        o.type=tp;o.frequency.value=f;
        g.gain.setValueAtTime(0.22,ctx.currentTime+t);
        g.gain.exponentialRampToValueAtTime(0.001,ctx.currentTime+t+0.22);
        o.start(ctx.currentTime+t);o.stop(ctx.currentTime+t+0.24);
      });
    } else {
      // achievement u otros
      const o=ctx.createOscillator(),g=ctx.createGain();
      o.connect(g);g.connect(ctx.destination);
      o.type='sine';o.frequency.value=880;
      g.gain.setValueAtTime(0.15,ctx.currentTime);
      g.gain.exponentialRampToValueAtTime(0.001,ctx.currentTime+0.3);
      o.start();o.stop(ctx.currentTime+0.3);
    }
  }catch(e){}
}

function toggleSound(){
  soundEnabled=!soundEnabled;
  localStorage.setItem('soundEnabled',soundEnabled);
  const btn=document.getElementById('soundToggle');
  if(btn)btn.textContent=soundEnabled?'üîî Sonido ON':'üîï Sonido OFF';
}

// (sonido controlado √∫nicamente por checkAnswer en bloque v12 m√°s abajo)

// ===== BOT√ìN SONIDO EN HEADER =====
(function(){
  window.addEventListener('load',()=>{
    setTimeout(()=>{
      const hdr=document.querySelector('.header');
      if(hdr&&!document.getElementById('soundToggle')){
        const btn=document.createElement('button');
        btn.id='soundToggle';
        btn.style.cssText='position:absolute;top:20px;left:20px;background:rgba(255,255,255,0.2);border:none;color:white;padding:8px 16px;border-radius:20px;cursor:pointer;font-size:14px';
        btn.textContent=soundEnabled?'üîî Sonido ON':'üîï Sonido OFF';
        btn.onclick=toggleSound;
        hdr.appendChild(btn);
      }
    },150);
  });
})();

// ===== BOTONES EXTRA EN MEN√ö =====
(function(){
  window.addEventListener('load',()=>{
    setTimeout(()=>{
      const startBtns=document.getElementById('startButtons');
      if(startBtns&&!document.getElementById('extraBtns')){
        const row=document.createElement('div');
        row.id='extraBtns';row.className='config-row';
        row.innerHTML='<button class="btn-config" onclick="showStreakCalendar()" style="background:#8b5cf6">üìÖ Racha Diaria</button><button class="btn-config" onclick="showTopicMastery()" style="background:#0ea5e9">üó∫Ô∏è Dominio por Tema</button><button class="btn-config" onclick="showLeaderboard()" style="background:#f59e0b">üèÜ Puntuaciones</button>';
        startBtns.insertAdjacentElement('afterend',row);
      }
    },150);
  });
})();

// ===== HELPER: volver al men√∫ desde p√°ginas extra =====
function backToHomeFromExtra(){
  const saved=localStorage.getItem('oracleQuizProgress');
  if(saved){try{const d=JSON.parse(saved);d.quizActive=false;localStorage.setItem('oracleQuizProgress',JSON.stringify(d));}catch(e){}}
  document.getElementById('configPanel').classList.remove('hidden');
  document.getElementById('progressBar').classList.add('hidden');
  document.getElementById('quizContent').classList.add('hidden');
  quizStarted=false;
}

// ===== üîÅ REPETICI√ìN ESPACIADA (tipo Anki) =====
// Algoritmo SM-2 simplificado: cada pregunta tiene intervalo de d√≠as
function getSRData(){const s=localStorage.getItem('oracleQuizSR');return s?JSON.parse(s):{};}
function saveSRData(d){localStorage.setItem('oracleQuizSR',JSON.stringify(d));}

function getDueSRQuestions(){
  const data=getSRData();
  const today=new Date().toISOString().split('T')[0];
  // Preguntas pendientes hoy: las que tienen nextReview <= hoy o nunca estudiadas
  const due=allQuestions.filter(q=>{
    const d=data[q.number];
    if(!d)return false; // nunca estudiadas en SR, no incluir hasta que se inicien
    return d.nextReview<=today;
  });
  return due;
}

function updateSR(qNum, knew){
  const data=getSRData();
  const today=new Date();
  const entry=data[qNum]||{interval:1,easeFactor:2.5,reviews:0};
  if(knew){
    entry.interval=entry.reviews===0?1:entry.reviews===1?6:Math.round(entry.interval*entry.easeFactor);
    entry.easeFactor=Math.max(1.3,entry.easeFactor+0.1);
  } else {
    entry.interval=1;
    entry.easeFactor=Math.max(1.3,entry.easeFactor-0.2);
  }
  entry.reviews=(entry.reviews||0)+1;
  const next=new Date(today);
  next.setDate(next.getDate()+entry.interval);
  entry.nextReview=next.toISOString().split('T')[0];
  entry.lastReview=today.toISOString().split('T')[0];
  data[qNum]=entry;
  saveSRData(data);
}

function initSRForAll(){
  const data=getSRData();
  const today=new Date().toISOString().split('T')[0];
  allQuestions.forEach(q=>{
    if(!data[q.number]){
      data[q.number]={interval:1,easeFactor:2.5,reviews:0,nextReview:today,lastReview:null};
    }
  });
  saveSRData(data);
}

let srIndex=0,srList=[],srSession={knew:0,review:0};

function startSRMode(){
  loadHistoricalData();
  initSRForAll();
  srList=getDueSRQuestions();
  if(srList.length===0){
    const data=getSRData();
    const allDates=Object.values(data).filter(d=>d.nextReview).map(d=>d.nextReview).sort();
    const next=allDates[0]||'ma√±ana';
    showExtraPage('<div style="text-align:center;padding:40px"><div style="font-size:64px;margin-bottom:20px">üéâ</div><h2 style="color:#10b981;margin-bottom:15px">¬°Al d√≠a!</h2><p style="color:#666;font-size:16px">No tienes preguntas pendientes para hoy.</p><p style="color:#888;margin-top:10px">Pr√≥xima revisi√≥n: <strong>'+next+'</strong></p></div>');
    return;
  }
  srIndex=0;srSession={knew:0,review:0};
  document.getElementById('configPanel').classList.add('hidden');
  document.getElementById('progressBar').classList.add('hidden');
  document.getElementById('quizContent').classList.remove('hidden');
  showSRCard();
}

function showSRCard(){
  if(srIndex>=srList.length){showSRResults();return;}
  const q=srList[srIndex];
  const data=getSRData();
  const entry=data[q.number]||{};
  const correctText=q.correct.map(i=>String.fromCharCode(65+i)+') '+q.options[i]).join('<br>');
  const qc=document.getElementById('quizContent');
  qc.innerHTML='<div style="padding:30px">'+
    '<div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:15px">'+
    '<span style="color:#667eea;font-weight:700;font-size:14px">üîÅ Repetici√≥n Espaciada ‚Äî '+srIndex+'/'+(srList.length)+' completadas</span>'+
    '<div style="display:flex;gap:8px">'+
    '<span style="background:#10b981;color:white;padding:3px 10px;border-radius:20px;font-size:12px">‚úÖ '+srSession.knew+'</span>'+
    '<span style="background:#ef4444;color:white;padding:3px 10px;border-radius:20px;font-size:12px">üîÅ '+srSession.review+'</span>'+
    '</div>'+
    '<button onclick="backToHomeFromExtra()" style="padding:8px 16px;background:#6b7280;color:white;border:none;border-radius:8px;cursor:pointer;font-weight:600;font-size:13px">‚Üê Salir</button>'+
    '</div>'+
    '<div style="background:linear-gradient(135deg,#667eea,#764ba2);color:white;border-radius:16px;padding:25px;margin-bottom:15px;text-align:center">'+
    '<div style="font-size:12px;opacity:0.8;margin-bottom:10px">Pregunta '+q.number+' ¬∑ Revisiones: '+(entry.reviews||0)+'</div>'+
    '<div style="font-size:17px;font-weight:600;line-height:1.5">'+q.text+'</div>'+
    '</div>'+
    '<div id="sr-answer" style="display:none;background:white;border:3px solid #10b981;border-radius:16px;padding:20px;margin-bottom:15px">'+
    '<div style="font-size:13px;font-weight:700;color:#667eea;margin-bottom:10px">‚úÖ Respuesta correcta:</div>'+
    '<div style="font-size:15px;line-height:1.7;color:#065f46">'+correctText+'</div>'+
    '</div>'+
    '<div id="sr-btns-show" style="text-align:center">'+
    '<button onclick="document.getElementById(\'sr-answer\').style.display=\'block\';document.getElementById(\'sr-btns-show\').style.display=\'none\';document.getElementById(\'sr-btns-rate\').style.display=\'flex\'" style="padding:14px 35px;background:linear-gradient(135deg,#667eea,#764ba2);color:white;border:none;border-radius:12px;cursor:pointer;font-size:16px;font-weight:600">üëÅÔ∏è Ver Respuesta</button>'+
    '</div>'+
    '<div id="sr-btns-rate" style="display:none;gap:12px;justify-content:center;flex-wrap:wrap">'+
    '<button onclick="srAnswer(false)" style="padding:12px 28px;background:#ef4444;color:white;border:none;border-radius:10px;cursor:pointer;font-size:15px;font-weight:600">üòì No lo sab√≠a</button>'+
    '<button onclick="srAnswer(true)" style="padding:12px 28px;background:#10b981;color:white;border:none;border-radius:10px;cursor:pointer;font-size:15px;font-weight:600">‚úÖ Lo sab√≠a</button>'+
    '</div>'+
    '</div>';
}

function srAnswer(knew){
  const q=srList[srIndex];
  updateSR(q.number,knew);
  if(knew)srSession.knew++;else srSession.review++;
  srIndex++;
  showSRCard();
}

function showSRResults(){
  const total=srSession.knew+srSession.review;
  const pct=total>0?Math.round((srSession.knew/total)*100):0;
  const c=pct>=70?'#10b981':pct>=50?'#f59e0b':'#ef4444';
  showExtraPage('<div style="text-align:center;padding:40px">'+
    '<h2 style="color:#667eea;margin-bottom:20px">üîÅ Sesi√≥n completada</h2>'+
    '<div style="font-size:56px;font-weight:bold;color:'+c+';margin:20px 0">'+pct+'%</div>'+
    '<p style="color:#666;margin-bottom:10px">Sab√≠as <strong>'+srSession.knew+'</strong> de <strong>'+total+'</strong></p>'+
    '<p style="color:#888;font-size:13px">Las preguntas que no sab√≠as volver√°n ma√±ana üìÖ</p>'+
    '<button onclick="backToHomeFromExtra()" style="margin-top:20px;padding:12px 25px;background:#667eea;color:white;border:none;border-radius:10px;font-size:15px;font-weight:600;cursor:pointer">‚Üê Volver al Men√∫</button>'+
    '</div>');
}


// ===== üìÜ OBJETIVO FECHA DE EXAMEN =====
function showExamCountdown(){
  const saved=localStorage.getItem('examDate')||'';
  const qc=document.getElementById('quizContent');
  document.getElementById('configPanel').classList.add('hidden');
  document.getElementById('progressBar').classList.add('hidden');
  qc.classList.remove('hidden');

  let countdownHTML='';
  if(saved){
    const exam=new Date(saved);
    const today=new Date();today.setHours(0,0,0,0);exam.setHours(0,0,0,0);
    const diff=Math.ceil((exam-today)/(1000*60*60*24));
    const attempts=getAttemptHistory();
    const avg=attempts.length>0?Math.round(attempts.reduce((s,a)=>s+a.percentage,0)/attempts.length):0;
    const totalQ=127;
    const studied=Object.keys(getSRData()).length;
    const perDay=diff>0?Math.ceil((totalQ-studied)/Math.max(diff,1)):0;
    const emoji=diff>14?'üìö':diff>7?'‚ö°':diff>0?'üî•':'üéì';
    const color=diff>14?'#667eea':diff>7?'#f59e0b':diff>0?'#ef4444':'#10b981';
    countdownHTML=diff>0?
      '<div style="background:linear-gradient(135deg,'+color+','+color+'99);color:white;border-radius:16px;padding:25px;text-align:center;margin-bottom:20px">'+
      '<div style="font-size:56px">'+emoji+'</div>'+
      '<div style="font-size:48px;font-weight:900;margin:10px 0">'+diff+'</div>'+
      '<div style="font-size:18px;font-weight:600">d√≠as para el examen</div>'+
      '<div style="font-size:13px;opacity:0.9;margin-top:8px">'+exam.toLocaleDateString('es-ES',{weekday:'long',day:'numeric',month:'long',year:'numeric'})+'</div>'+
      '</div>'+
      '<div style="display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-bottom:20px">'+
      '<div style="background:#f8f9ff;border-radius:12px;padding:15px;text-align:center"><div style="font-size:28px;font-weight:bold;color:#667eea">'+avg+'%</div><div style="font-size:12px;color:#666">Tu promedio actual</div></div>'+
      '<div style="background:#f8f9ff;border-radius:12px;padding:15px;text-align:center"><div style="font-size:28px;font-weight:bold;color:#f59e0b">~'+perDay+'</div><div style="font-size:12px;color:#666">preguntas/d√≠a recomendadas</div></div>'+
      '</div>':
      '<div style="background:#10b981;color:white;border-radius:16px;padding:25px;text-align:center;margin-bottom:20px">'+
      '<div style="font-size:56px">üéì</div><div style="font-size:24px;font-weight:700;margin-top:10px">¬°Hoy es el d√≠a del examen!</div>'+
      '<div style="font-size:16px;opacity:0.9;margin-top:8px">¬°Mucha suerte Edgar! üí™</div></div>';
  }

  qc.innerHTML='<div style="padding:30px">'+
    '<div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:20px">'+
    '<h2 style="color:#667eea">üìÜ Fecha del Examen</h2>'+
    '<button onclick="backToHomeFromExtra()" style="padding:10px 20px;background:#6b7280;color:white;border:none;border-radius:8px;cursor:pointer;font-weight:600">‚Üê Volver</button>'+
    '</div>'+
    countdownHTML+
    '<div style="background:#f8f9ff;border-radius:12px;padding:20px">'+
    '<label style="font-size:14px;font-weight:600;color:#667eea;display:block;margin-bottom:8px">üìÖ Fecha del examen Oracle 1z0-133:</label>'+
    '<input type="date" id="examDateInput" value="'+saved+'" style="width:100%;padding:12px;border:2px solid #667eea;border-radius:8px;font-size:16px;margin-bottom:10px">'+
    '<button onclick="saveExamDate()" style="width:100%;padding:12px;background:linear-gradient(135deg,#667eea,#764ba2);color:white;border:none;border-radius:8px;font-size:15px;font-weight:600;cursor:pointer">üíæ Guardar fecha</button>'+
    '</div>'+
    '</div>';
}

function saveExamDate(){
  const val=document.getElementById('examDateInput')?.value;
  if(val){localStorage.setItem('examDate',val);showExamCountdown();}
}


// ===== üéñÔ∏è LOGROS POR TEMA =====
const topicAchievements={
  cluster:{name:'Maestro del Cl√∫ster',emoji:'üîó',threshold:80},
  node:{name:'Experto Node Manager',emoji:'üñ•Ô∏è',threshold:80},
  jdbc:{name:'Gur√∫ JDBC',emoji:'üóÑÔ∏è',threshold:80},
  security:{name:'Guardi√°n de Seguridad',emoji:'üîí',threshold:80},
  deploy:{name:'Pro del Deployment',emoji:'üöÄ',threshold:80},
  domain:{name:'Arquitecto de Dominios',emoji:'üèóÔ∏è',threshold:80},
  monitor:{name:'Ojo del Sistema',emoji:'üìä',threshold:80},
  jvm:{name:'Hechicero JVM',emoji:'‚òï',threshold:80}
};

function checkTopicAchievements(){
  loadHistoricalData();
  const unlocked=JSON.parse(localStorage.getItem('topicAchievements')||'{}');
  let newUnlock=false;
  Object.entries(questionTopics).forEach(([key,nums])=>{
    if(unlocked[key])return;
    const total=nums.length;
    const incorrect=nums.filter(n=>historicallyIncorrect.has(n)).length;
    const pct=Math.round(((total-incorrect)/total)*100);
    if(pct>=topicAchievements[key].threshold){
      unlocked[key]=true;
      newUnlock=true;
      const ach=topicAchievements[key];
      showAchievementPopup('üéñÔ∏è '+ach.emoji+' '+ach.name,'¬°Dominas este tema al '+pct+'%!');
      playSound('achievement');
    }
  });
  if(newUnlock)localStorage.setItem('topicAchievements',JSON.stringify(unlocked));
}

function showAllAchievements(){
  loadHistoricalData();
  const unlocked=JSON.parse(localStorage.getItem('topicAchievements')||'{}');
  const shownAch=JSON.parse(localStorage.getItem('oracleAchievements')||'[]');

  // Logros de tema
  const topicRows=Object.entries(topicAchievements).map(([key,ach])=>{
    const nums=questionTopics[key];
    const total=nums.length;
    const incorrect=nums.filter(n=>historicallyIncorrect.has(n)).length;
    const pct=Math.round(((total-incorrect)/total)*100);
    const done=unlocked[key];
    return'<div style="display:flex;align-items:center;gap:15px;padding:14px;border-radius:12px;margin-bottom:8px;background:'+(done?'linear-gradient(135deg,#f0fdf4,#dcfce7)':'#f8f9ff')+';border:2px solid '+(done?'#10b981':'#e0e0e0')+'">'+
      '<div style="font-size:32px;'+(done?'':'filter:grayscale(1);opacity:0.4')+'">'+ach.emoji+'</div>'+
      '<div style="flex:1"><div style="font-weight:700;font-size:14px;color:'+(done?'#065f46':'#666')+'">'+ach.name+'</div>'+
      '<div style="font-size:12px;color:#888;margin-top:2px">Dominar al 80% ¬∑ Progreso actual: '+pct+'%</div>'+
      '<div style="background:#e0e0e0;border-radius:4px;height:6px;margin-top:6px;overflow:hidden"><div style="width:'+Math.min(pct,100)+'%;background:'+(done?'#10b981':'#667eea')+';height:100%;border-radius:4px"></div></div></div>'+
      (done?'<div style="color:#10b981;font-size:20px">‚úÖ</div>':'<div style="color:#ccc;font-size:20px">üîí</div>')+
      '</div>';
  }).join('');

  showExtraPage('<div style="padding:30px">'+
    '<h2 style="color:#667eea;margin-bottom:5px">üéñÔ∏è Logros</h2>'+
    '<p style="color:#888;font-size:13px;margin-bottom:20px">'+Object.keys(unlocked).length+' de '+Object.keys(topicAchievements).length+' logros de tema desbloqueados</p>'+
    topicRows+
    '</div>');
}

// Hook checkAnswer para verificar logros de tema
(function(){
  const _origCAach=checkAnswer;
  checkAnswer=function(){
    _origCAach();
    setTimeout(checkTopicAchievements,200);
  };
})();


// ===== üìà PREDICCI√ìN DE NOTA =====
function showScorePrediction(){
  loadHistoricalData();
  const attempts=getAttemptHistory();
  const qc=document.getElementById('quizContent');
  document.getElementById('configPanel').classList.add('hidden');
  document.getElementById('progressBar').classList.add('hidden');
  qc.classList.remove('hidden');

  if(attempts.length<2){
    qc.innerHTML='<div style="padding:40px;text-align:center">'+
      '<div style="font-size:56px;margin-bottom:20px">üìà</div>'+
      '<h2 style="color:#667eea;margin-bottom:15px">Predicci√≥n de Nota</h2>'+
      '<p style="color:#888">Necesitas al menos <strong>2 intentos</strong> para generar una predicci√≥n.</p>'+
      '<p style="color:#888;margin-top:8px">Completa m√°s quizzes y vuelve aqu√≠.</p>'+
      '<button onclick="backToHomeFromExtra()" style="margin-top:20px;padding:12px 25px;background:#667eea;color:white;border:none;border-radius:10px;font-size:15px;font-weight:600;cursor:pointer">‚Üê Volver</button>'+
      '</div>';
    return;
  }

  // Calcular tendencia con regresi√≥n lineal simple
  const last=attempts.slice(-5);
  const n=last.length;
  const xs=last.map((_,i)=>i);
  const ys=last.map(a=>a.percentage);
  const xMean=xs.reduce((a,b)=>a+b,0)/n;
  const yMean=ys.reduce((a,b)=>a+b,0)/n;
  const slope=(xs.reduce((s,x,i)=>s+(x-xMean)*(ys[i]-yMean),0))/(xs.reduce((s,x)=>s+(x-xMean)**2,0)||1);
  const intercept=yMean-slope*xMean;
  const predicted=Math.min(100,Math.max(0,Math.round(intercept+slope*n)));
  const trend=slope>1?'üìà Mejorando':slope<-1?'üìâ Bajando':'‚û°Ô∏è Estable';
  const trendColor=slope>1?'#10b981':slope<-1?'#ef4444':'#667eea';
  const passPct=68; // Oracle exige ~68% para aprobar
  const willPass=predicted>=passPct;
  const daysToPass=willPass?0:slope>0?Math.ceil((passPct-predicted)/slope):null;

  // Dominio por temas
  const topicNames={cluster:'Clusters',node:'Node Manager',jdbc:'JDBC',security:'Seguridad',deploy:'Deployment',domain:'Dominios',monitor:'Monitor',jvm:'JVM'};
  const weakTopics=Object.entries(questionTopics).map(([key,nums])=>{
    const pct=Math.round(((nums.length-nums.filter(n=>historicallyIncorrect.has(n)).length)/nums.length)*100);
    return{name:topicNames[key],pct};
  }).filter(t=>t.pct<70).sort((a,b)=>a.pct-b.pct).slice(0,3);

  qc.innerHTML='<div style="padding:30px">'+
    '<div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:20px">'+
    '<h2 style="color:#667eea">üìà Predicci√≥n de Nota</h2>'+
    '<button onclick="backToHomeFromExtra()" style="padding:10px 20px;background:#6b7280;color:white;border:none;border-radius:8px;cursor:pointer;font-weight:600">‚Üê Volver</button>'+
    '</div>'+
    '<div style="background:linear-gradient(135deg,'+(willPass?'#10b981':'#667eea')+','+(willPass?'#059669':'#764ba2')+');color:white;border-radius:16px;padding:25px;text-align:center;margin-bottom:20px">'+
    '<div style="font-size:14px;opacity:0.9;margin-bottom:8px">Basado en tus √∫ltimos '+n+' intentos</div>'+
    '<div style="font-size:64px;font-weight:900">'+predicted+'%</div>'+
    '<div style="font-size:16px;margin-top:5px">Nota predicha para tu pr√≥ximo examen</div>'+
    '<div style="margin-top:12px;padding:8px 20px;background:rgba(255,255,255,0.2);border-radius:20px;display:inline-block;font-size:14px;font-weight:600">'+
    (willPass?'‚úÖ APROBAR√çAS (m√≠nimo '+passPct+'%)':'‚ùå A√öN NO LLEGAS al '+passPct+'% m√≠nimo')+
    '</div></div>'+
    '<div style="display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-bottom:20px">'+
    '<div style="background:#f8f9ff;border-radius:12px;padding:15px;text-align:center">'+
    '<div style="font-size:22px;font-weight:bold;color:'+trendColor+'">'+trend+'</div>'+
    '<div style="font-size:12px;color:#666;margin-top:4px">Tendencia</div></div>'+
    '<div style="background:#f8f9ff;border-radius:12px;padding:15px;text-align:center">'+
    '<div style="font-size:22px;font-weight:bold;color:#667eea">'+(daysToPass===null?'‚Äî':daysToPass===0?'¬°Ya!':'+'+daysToPass+' intentos')+'</div>'+
    '<div style="font-size:12px;color:#666;margin-top:4px">Para llegar al '+passPct+'%</div></div>'+
    '</div>'+
    (weakTopics.length>0?'<div style="background:#fff5f5;border:2px solid #fecaca;border-radius:12px;padding:15px;margin-bottom:20px">'+
    '<div style="font-weight:700;color:#ef4444;margin-bottom:10px">‚ö†Ô∏è Temas a reforzar:</div>'+
    weakTopics.map(t=>'<div style="display:flex;justify-content:space-between;padding:6px 0;font-size:14px"><span>'+t.name+'</span><span style="font-weight:700;color:#ef4444">'+t.pct+'%</span></div>').join('')+
    '</div>':'')+
    '<p style="color:#aaa;font-size:11px;text-align:center">* Predicci√≥n basada en tendencia de tus √∫ltimos intentos</p>'+
    '</div>';
}


// ===== üñ®Ô∏è PDF TODAS LAS PREGUNTAS =====
function exportAllPDF(){
  let html='<!DOCTYPE html><html><head><meta charset="UTF-8"><title>Oracle 1z0-133 - Todas las Preguntas</title><style>'+
    'body{font-family:Arial,sans-serif;padding:30px;color:#333;max-width:800px;margin:0 auto}'+
    'h1{color:#667eea;border-bottom:3px solid #667eea;padding-bottom:10px}'+
    '.meta{color:#888;font-size:13px;margin-bottom:25px}'+
    '.question{margin-bottom:20px;padding:18px;border-left:5px solid #667eea;background:#f8f9ff;border-radius:0 8px 8px 0;page-break-inside:avoid}'+
    '.qnum{font-size:11px;color:#667eea;font-weight:700;margin-bottom:6px}'+
    '.qtext{font-size:14px;font-weight:600;margin-bottom:10px;line-height:1.5}'+
    '.options{font-size:13px;margin-bottom:8px}'+
    '.option{padding:3px 0;color:#555}'+
    '.option.correct{color:#065f46;font-weight:700;background:#d1fae5;padding:3px 6px;border-radius:4px}'+
    '@media print{body{padding:15px}.question{break-inside:avoid}}'+
    '</style></head><body>'+
    '<h1>üìö Oracle 1z0-133 ‚Äî Todas las Preguntas</h1>'+
    '<div class="meta">EDGAR PINTO MATUMINY ¬∑ Generado el '+new Date().toLocaleDateString('es-ES',{day:'2-digit',month:'long',year:'numeric'})+' ¬∑ 127 preguntas</div>';

  allQuestions.forEach(q=>{
    const letters=['A','B','C','D','E','F','G'];
    html+='<div class="question">'+
      '<div class="qnum">PREGUNTA '+q.number+'</div>'+
      '<div class="qtext">'+q.text+'</div>'+
      '<div class="options">'+
      q.options.map((opt,i)=>'<div class="option'+(q.correct.includes(i)?' correct':'')+'">'+letters[i]+') '+opt+(q.correct.includes(i)?' ‚úì':'')+'</div>').join('')+
      '</div></div>';
  });

  html+='</body></html>';
  const blob=new Blob([html],{type:'text/html'});
  const url=URL.createObjectURL(blob);
  const win=window.open(url,'_blank');
  if(win)setTimeout(()=>win.print(),600);
}


// ===== üîî RECORDATORIO DIARIO =====
function setupDailyReminder(){
  if(!('Notification' in window)){
    alert('Tu navegador no soporta notificaciones.');return;
  }
  Notification.requestPermission().then(perm=>{
    if(perm==='granted'){
      localStorage.setItem('dailyReminder','true');
      showReminderStatus();
      alert('‚úÖ Recordatorio activado. Recibir√°s una notificaci√≥n cuando abras el quiz cada d√≠a.');
    } else {
      alert('‚ùå Permiso denegado. Activa las notificaciones en la configuraci√≥n del navegador.');
    }
  });
}

function checkDailyReminder(){
  if(localStorage.getItem('dailyReminder')!=='true')return;
  const last=localStorage.getItem('lastReminderDate')||'';
  const today=new Date().toISOString().split('T')[0];
  if(last===today)return;
  localStorage.setItem('lastReminderDate',today);
  const {streak}=getDailyStreak();
  if(Notification.permission==='granted'){
    new Notification('üìö Oracle Quiz ‚Äî ¬°A estudiar!',{
      body:'Hola Edgar üëã Llevas '+streak+' d√≠as de racha. ¬°No la rompas hoy!',
      icon:'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><text y=".9em" font-size="90">üìö</text></svg>'
    });
  }
}

function showReminderStatus(){
  const active=localStorage.getItem('dailyReminder')==='true';
  const btn=document.getElementById('reminderBtn');
  if(btn)btn.textContent=active?'üîî Recordatorio ON':'üîï Recordatorio OFF';
}

// Verificar recordatorio al cargar
window.addEventListener('load',()=>{setTimeout(checkDailyReminder,2000);});


// ===== A√ëADIR BOTONES NUEVOS AL MEN√ö =====
(function(){
  window.addEventListener('load',()=>{
    setTimeout(()=>{
      const extraBtns=document.getElementById('extraBtns');
      if(extraBtns&&!document.getElementById('extraBtns2')){
        const row=document.createElement('div');
        row.id='extraBtns2';row.className='config-row';
        row.innerHTML=
          '<button class="btn-config" onclick="startSRMode()" style="background:#06b6d4">üîÅ Repetici√≥n Espaciada</button>'+
          '<button class="btn-config" onclick="showExamCountdown()" style="background:#ef4444">üìÜ Fecha del Examen</button>'+
          '<button class="btn-config" onclick="showAllAchievements()" style="background:#f59e0b">üéñÔ∏è Logros</button>'+
          '<button class="btn-config" onclick="showScorePrediction()" style="background:#10b981">üìà Predecir Nota</button>'+
          '<button class="btn-config" onclick="exportAllPDF()" style="background:#6366f1">üñ®Ô∏è PDF Completo</button>'+
          '<button id="reminderBtn" class="btn-config" onclick="setupDailyReminder()" style="background:#ec4899">üîî Recordatorio</button>';
        extraBtns.insertAdjacentElement('afterend',row);
        showReminderStatus();
      }
    },200);
  });
})();


// ===== HELPER: mostrar p√°gina extra gen√©rica =====
function showExtraPage(html){
  const qc=document.getElementById('quizContent');
  document.getElementById('configPanel').classList.add('hidden');
  document.getElementById('progressBar').classList.add('hidden');
  qc.classList.remove('hidden');
  qc.innerHTML='<div style="padding:30px"><div style="display:flex;justify-content:flex-end;margin-bottom:15px">'+
    '<button onclick="backToHomeFromExtra()" style="padding:10px 20px;background:#6b7280;color:white;border:none;border-radius:8px;cursor:pointer;font-weight:600">‚Üê Volver</button></div>'+
    html+'</div>';
}

// ==========================================
// ‚ú® NUEVAS FUNCIONALIDADES v12
// ==========================================

// ‚îÄ‚îÄ 1. MAPA DE PROGRESO ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function showProgressMap(){
  if(!questions||questions.length===0){alert('‚ö†Ô∏è Inicia un quiz primero.');return;}
  const qc=document.getElementById('quizContent');
  let cells='';
  questions.forEach((q,idx)=>{
    const id=q.number;
    const isChecked=checkedQuestions[id];
    const ua=answers[id];
    let bg='#e0e0e0',title='Sin responder',emoji='‚¨ú';
    if(idx===currentQuestion){bg='#667eea';title='Pregunta actual';emoji='üîµ';}
    else if(isChecked){
      const ok=ua&&ua.length===q.correct.length&&ua.every(a=>q.correct.includes(a));
      bg=ok?'#10b981':'#ef4444';title=ok?'Correcta':'Incorrecta';emoji=ok?'üü¢':'üî¥';
    } else if(ua&&ua.length>0){bg='#f59e0b';title='Respondida sin verificar';emoji='üü°';}
    cells+=`<div onclick="jumpToQuestion(${idx})" title="P${id}: ${title}" style="width:36px;height:36px;border-radius:8px;background:${bg};cursor:pointer;display:flex;align-items:center;justify-content:center;font-size:13px;font-weight:700;color:white;border:2px solid rgba(255,255,255,0.3);transition:transform 0.1s" onmouseover="this.style.transform='scale(1.2)'" onmouseout="this.style.transform='scale(1)'">${idx+1}</div>`;
  });
  const legend='<div style="display:flex;gap:15px;flex-wrap:wrap;margin-bottom:15px;font-size:12px">'+
    '<span>üîµ Actual</span><span>üü¢ Correcta</span><span>üî¥ Incorrecta</span><span>üü° Sin verificar</span><span style="background:#e0e0e0;padding:1px 6px;border-radius:4px">‚¨ú Sin responder</span></div>';
  const html=`<h3 style="color:#667eea;margin-bottom:12px">üó∫Ô∏è Mapa de Progreso (${questions.length} preguntas)</h3>${legend}<div style="display:flex;flex-wrap:wrap;gap:8px">${cells}</div>`;
  // Mostrar como overlay sobre el quiz actual
  let overlay=document.getElementById('progressMapOverlay');
  if(overlay){overlay.remove();return;}
  overlay=document.createElement('div');
  overlay.id='progressMapOverlay';
  overlay.style.cssText='position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.6);z-index:1000;display:flex;align-items:center;justify-content:center;padding:20px';
  overlay.innerHTML=`<div style="background:white;border-radius:16px;padding:25px;max-width:700px;width:100%;max-height:80vh;overflow-y:auto;position:relative">
    <button onclick="document.getElementById('progressMapOverlay').remove()" style="position:absolute;top:12px;right:12px;background:#ef4444;color:white;border:none;border-radius:50%;width:30px;height:30px;cursor:pointer;font-size:16px;font-weight:bold">‚úï</button>
    ${html}
    <p style="margin-top:15px;font-size:12px;color:#888">üí° Haz clic en cualquier cuadro para saltar a esa pregunta</p>
  </div>`;
  document.body.appendChild(overlay);
  // Dark mode support
  if(document.body.classList.contains('dark-mode')){
    overlay.querySelector('div').style.background='#252b42';
    overlay.querySelector('div').style.color='#e0e0e0';
  }
}

function jumpToQuestion(idx){
  currentQuestion=idx;
  document.getElementById('progressMapOverlay')?.remove();
  loadQuestion();
}

// ‚îÄ‚îÄ 2. PAUSAR SIMULACRO ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
let simulacroPaused=false;
let simulacroRemainingSeconds=0;


function startSimulacroTimer(totalSeconds){
  simulacroRemainingSeconds=totalSeconds;
  simulacroPaused=false;
  clearInterval(simulacroTimerInterval);
  // A√±adir bot√≥n pausa junto al timer
  setTimeout(()=>{
    const td=document.getElementById('timerDisplay');
    if(td&&!document.getElementById('pauseSimBtn')){
      const btn=document.createElement('button');
      btn.id='pauseSimBtn';
      btn.textContent='‚è∏Ô∏è Pausar';
      btn.style.cssText='background:rgba(255,255,255,0.25);color:white;border:2px solid white;padding:6px 14px;border-radius:8px;cursor:pointer;font-size:13px;font-weight:600;margin-left:15px;vertical-align:middle';
      btn.onclick=togglePauseSimulacro;
      td.appendChild(btn);
    }
  },500);
  function update(){
    if(simulacroPaused)return;
    simulacroRemainingSeconds--;
    const h=Math.floor(simulacroRemainingSeconds/3600);
    const m=Math.floor((simulacroRemainingSeconds%3600)/60);
    const s=simulacroRemainingSeconds%60;
    const td=document.getElementById('timerDisplay');
    if(td){
      const timeStr='üéØ SIMULACRO &nbsp; ‚è±Ô∏è '+String(h).padStart(2,'0')+':'+String(m).padStart(2,'0')+':'+String(s).padStart(2,'0');
      // Preserve pause button
      const btn=document.getElementById('pauseSimBtn');
      td.innerHTML=timeStr;
      if(btn)td.appendChild(btn);
    }
    if(simulacroRemainingSeconds<=0){
      clearInterval(simulacroTimerInterval);
      alert('‚è∞ ¬°Tiempo agotado! El simulacro ha terminado.');
      showResults();
    }
  }
  simulacroTimerInterval=setInterval(update,1000);
}

function togglePauseSimulacro(){
  simulacroPaused=!simulacroPaused;
  const btn=document.getElementById('pauseSimBtn');
  if(btn){
    btn.textContent=simulacroPaused?'‚ñ∂Ô∏è Reanudar':'‚è∏Ô∏è Pausar';
    btn.style.background=simulacroPaused?'rgba(239,68,68,0.4)':'rgba(255,255,255,0.25)';
  }
  if(simulacroPaused){
    showPopup('‚è∏Ô∏è Simulacro Pausado','El cron√≥metro est√° detenido');
  }else{
    showPopup('‚ñ∂Ô∏è Simulacro Reanudado','El cron√≥metro sigue corriendo');
  }
}

// ‚îÄ‚îÄ 3. AN√ÅLISIS POR TEMAS ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function showTopicAnalysis(){
  if(!checkedQuestions||Object.keys(checkedQuestions).length===0){
    alert('‚ö†Ô∏è Responde algunas preguntas primero para ver el an√°lisis.');return;
  }
  let rows='';
  Object.entries(questionTopics).forEach(([key,nums])=>{
    const answered=nums.filter(n=>checkedQuestions[n]);
    if(answered.length===0)return;
    const correct=answered.filter(n=>{
      const q=allQuestions.find(x=>x.number===n);
      const ua=answers[n];
      if(!q||!ua)return false;
      return ua.length===q.correct.length&&ua.every(a=>q.correct.includes(a));
    });
    const pct=Math.round((correct.length/answered.length)*100);
    const color=pct>=70?'#10b981':pct>=50?'#f59e0b':'#ef4444';
    const emoji=pct>=70?'‚úÖ':pct>=50?'‚ö†Ô∏è':'‚ùå';
    const label=key.replace(/_/g,' ').replace(/\b\w/g,c=>c.toUpperCase());
    rows+=`<div style="margin-bottom:12px">
      <div style="display:flex;justify-content:space-between;margin-bottom:4px">
        <span style="font-size:13px;font-weight:600">${emoji} ${label}</span>
        <span style="font-size:13px;font-weight:700;color:${color}">${pct}% (${correct.length}/${answered.length})</span>
      </div>
      <div style="background:#e0e0e0;border-radius:10px;height:10px;overflow:hidden">
        <div style="background:${color};height:100%;width:${pct}%;border-radius:10px;transition:width 0.5s"></div>
      </div>
    </div>`;
  });
  const html=`<h3 style="color:#667eea;margin-bottom:20px">üìä An√°lisis por Temas</h3>${rows||'<p style="color:#888">No hay suficientes datos todav√≠a.</p>'}`;
  showExtraPage(html);
}

// A√±adir bot√≥n de An√°lisis por Temas en resultados

function showResults(){
  _baseShowResultsV12();
  setTimeout(()=>{
    const fr=document.querySelector('.final-results');
    if(fr&&!document.getElementById('topicAnalysisBtn')){
      const btn=document.createElement('button');
      btn.id='topicAnalysisBtn';
      btn.style.cssText='background:#06b6d4;color:white;border:none;padding:12px 25px;border-radius:10px;font-size:15px;font-weight:600;cursor:pointer;margin-top:10px;display:block;margin-left:auto;margin-right:auto';
      btn.innerHTML='üìä An√°lisis por Temas';
      btn.onclick=showTopicAnalysis;
      fr.appendChild(btn);
    }
  },100);
}

// ‚îÄ‚îÄ 4. SONIDOS ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
// √öNICO punto de disparo de sonido al verificar
function checkAnswer(){
  const q=questions[currentQuestion];
  const ua=answers[q.number];if(!ua||ua.length===0)return;
  const isCorrect=ua.length===q.correct.length&&ua.every(a=>q.correct.includes(a));
  _baseCheckAnswerV12();
  // Disparar el sonido DESPU√âS de que la UI actualice el resultado
  setTimeout(()=>playSound(isCorrect?'correct':'incorrect'),80);
}

// Sonido al completar el quiz
function nextQuestion(){
  if(currentQuestion===questions.length-1){
    // fanfarria de fin
    if(soundEnabled){try{
      const ctx=new(window.AudioContext||window.webkitAudioContext)();
      [523,659,784,1047].forEach((f,i)=>{
        const o=ctx.createOscillator(),g=ctx.createGain();
        o.connect(g);g.connect(ctx.destination);
        o.frequency.value=f;g.gain.setValueAtTime(0.2,ctx.currentTime+i*0.12);
        g.gain.exponentialRampToValueAtTime(0.001,ctx.currentTime+i*0.12+0.2);
        o.start(ctx.currentTime+i*0.12);o.stop(ctx.currentTime+i*0.12+0.2);
      });
    }catch(e){}}
  }
  _baseNextQuestionV12();
}

// ‚îÄ‚îÄ 5. PWA (Modo sin conexi√≥n) ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
// A√±adir meta tags y manifest para PWA
(function setupPWA(){
  // A√±adir manifest inline
  const manifest={
    name:'Oracle 1z0-133 Quiz - Edgar Pinto',
    short_name:'Oracle Quiz',
    description:'Quiz de preparaci√≥n para Oracle WebLogic Server 12c Administration I',
    start_url:'.',
    display:'standalone',
    background_color:'#667eea',
    theme_color:'#667eea',
    icons:[{src:'https://img.icons8.com/color/96/oracle-logo.png',sizes:'96x96',type:'image/png'}]
  };
  const blob=new Blob([JSON.stringify(manifest)],{type:'application/json'});
  const url=URL.createObjectURL(blob);
  const link=document.createElement('link');
  link.rel='manifest';link.href=url;
  document.head.appendChild(link);
  // Meta theme color
  const meta=document.createElement('meta');
  meta.name='theme-color';meta.content='#667eea';
  document.head.appendChild(meta);
  // Apple PWA
  const apple=document.createElement('meta');
  apple.name='apple-mobile-web-app-capable';apple.content='yes';
  document.head.appendChild(apple);
})();

// ‚îÄ‚îÄ 6. SONIDOS EN TODOS LOS CLICS ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

// Sonido suave tipo "tick" para clics generales
function playClickSound(){
  if(!soundEnabled)return;
  try{
    const ctx=new(window.AudioContext||window.webkitAudioContext)();
    const o=ctx.createOscillator(),g=ctx.createGain();
    o.connect(g);g.connect(ctx.destination);
    o.type='sine';
    o.frequency.setValueAtTime(800,ctx.currentTime);
    o.frequency.exponentialRampToValueAtTime(600,ctx.currentTime+0.06);
    g.gain.setValueAtTime(0.12,ctx.currentTime);
    g.gain.exponentialRampToValueAtTime(0.001,ctx.currentTime+0.08);
    o.start();o.stop(ctx.currentTime+0.08);
  }catch(e){}
}

// Sonido especial para seleccionar opci√≥n (respuesta)
function playSelectSound(){
  if(!soundEnabled)return;
  try{
    const ctx=new(window.AudioContext||window.webkitAudioContext)();
    const o=ctx.createOscillator(),g=ctx.createGain();
    o.connect(g);g.connect(ctx.destination);
    o.type='sine';
    o.frequency.setValueAtTime(440,ctx.currentTime);
    o.frequency.setValueAtTime(550,ctx.currentTime+0.05);
    g.gain.setValueAtTime(0.15,ctx.currentTime);
    g.gain.exponentialRampToValueAtTime(0.001,ctx.currentTime+0.12);
    o.start();o.stop(ctx.currentTime+0.12);
  }catch(e){}
}

// Sonido para bot√≥n Verificar
function playVerifySound(){
  if(!soundEnabled)return;
  try{
    const ctx=new(window.AudioContext||window.webkitAudioContext)();
    [440,550].forEach((f,i)=>{
      const o=ctx.createOscillator(),g=ctx.createGain();
      o.connect(g);g.connect(ctx.destination);
      o.type='sine';o.frequency.value=f;
      g.gain.setValueAtTime(0.15,ctx.currentTime+i*0.07);
      g.gain.exponentialRampToValueAtTime(0.001,ctx.currentTime+i*0.07+0.1);
      o.start(ctx.currentTime+i*0.07);o.stop(ctx.currentTime+i*0.07+0.1);
    });
  }catch(e){}
}

// Sonido para navegaci√≥n (siguiente / anterior)
function playNavSound(forward){
  if(!soundEnabled)return;
  try{
    const ctx=new(window.AudioContext||window.webkitAudioContext)();
    const o=ctx.createOscillator(),g=ctx.createGain();
    o.connect(g);g.connect(ctx.destination);
    o.type='sine';
    o.frequency.setValueAtTime(forward?350:280,ctx.currentTime);
    o.frequency.exponentialRampToValueAtTime(forward?500:200,ctx.currentTime+0.1);
    g.gain.setValueAtTime(0.1,ctx.currentTime);
    g.gain.exponentialRampToValueAtTime(0.001,ctx.currentTime+0.12);
    o.start();o.stop(ctx.currentTime+0.12);
  }catch(e){}
}

// Interceptar clicks globalmente para asignar sonidos seg√∫n el elemento
document.addEventListener('click',function(e){
  const el=e.target.closest('button,.option,.mode-btn,.btn-fc,.btn-config');
  if(!el)return;

  // Opciones de respuesta
  if(el.classList.contains('option')&&!el.classList.contains('disabled')){
    playSelectSound();return;
  }
  // Bot√≥n Verificar
  if(el.classList.contains('btn-check')){
    playVerifySound();return;
  }
  // Navegaci√≥n siguiente
  if(el.classList.contains('btn-next')){
    playNavSound(true);return;
  }
  // Navegaci√≥n anterior
  if(el.classList.contains('btn-prev')){
    playNavSound(false);return;
  }
  // Cualquier otro bot√≥n
  playClickSound();
},true);

// ‚îÄ‚îÄ INTEGRAR BOTONES EN LA UI ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
window.addEventListener('load',()=>{
  // Cargar preferencia de sonido
  const savedSound=localStorage.getItem('soundEnabled');
  if(savedSound!==null)soundEnabled=savedSound==='true';

  // A√±adir botones nuevos en la pantalla principal despu√©s de un momento
  setTimeout(()=>{
    const extraBtns=document.getElementById('extraBtns');
    if(extraBtns){
      // Bot√≥n mapa de progreso (solo visible durante quiz)
      const mapBtn=document.createElement('button');
      mapBtn.id='mapBtn';
      mapBtn.className='btn-config';
      mapBtn.style.cssText='background:#8b5cf6;display:none';
      mapBtn.innerHTML='üó∫Ô∏è Mapa de Progreso';
      mapBtn.onclick=showProgressMap;
      extraBtns.appendChild(mapBtn);

      // Bot√≥n an√°lisis por temas
      const topicBtn=document.createElement('button');
      topicBtn.className='btn-config';
      topicBtn.style.background='#06b6d4';
      topicBtn.innerHTML='üìä An√°lisis por Temas';
      topicBtn.onclick=showTopicAnalysis;
      extraBtns.appendChild(topicBtn);

      // Bot√≥n instalar PWA
      const pwaBtn=document.createElement('button');
      pwaBtn.id='pwaInstallBtn';
      pwaBtn.className='btn-config';
      pwaBtn.style.cssText='background:#f59e0b;display:none';
      pwaBtn.innerHTML='üì± Instalar App';
      extraBtns.appendChild(pwaBtn);
    }

    // Bot√≥n mapa durante el quiz (en la barra de progreso)
    const pb=document.getElementById('progressBar');
    if(pb&&!document.getElementById('mapBtnQuiz')){
      const btn=document.createElement('button');
      btn.id='mapBtnQuiz';
      btn.style.cssText='position:absolute;right:10px;top:-6px;background:#8b5cf6;color:white;border:none;padding:3px 10px;border-radius:6px;font-size:11px;font-weight:600;cursor:pointer;z-index:10';
      btn.innerHTML='üó∫Ô∏è Mapa';
      btn.onclick=showProgressMap;
      pb.style.position='relative';
      pb.appendChild(btn);
    }
  },300);

  // PWA install prompt
  window.addEventListener('beforeinstallprompt',(e)=>{
    e.preventDefault();
    const btn=document.getElementById('pwaInstallBtn');
    if(btn){
      btn.style.display='inline-block';
      btn.onclick=()=>{e.prompt();};
    }
  });
});

// ‚îÄ‚îÄ REGISTRAR SERVICE WORKER ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
if('serviceWorker' in navigator){
  window.addEventListener('load',()=>{
    navigator.serviceWorker.register('/oracle-quiz/pwabuilder-sw.js')
      .then(reg=>console.log('‚úÖ Service Worker registrado',reg))
      .catch(err=>console.log('‚ùå Error Service Worker',err));
  });
}
</script>
</body>
</html>
